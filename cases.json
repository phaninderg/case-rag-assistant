{
  "cases": [
    {
      "case_number": "CSTASK1108571",
      "parent_case": "CS8313907",
      "subject": "Splunk-SecOPS Add-on: Issue with Content of Created SIR Tickets",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on : nn The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: ServiceNow Security Operations Addon is integrated with the product. https://splunkbase.splunk.com/app/3921 This addon is supported byServicenow. Can you please provide some pointers on why duplicate SIR incidents are being created with the same description? Splunk latest plug-in : 1.40.3 Issue Definition: The customer is experiencing issues with the messed-up content of SIR (Security Response Task) tickets, which are being created via the \"ServiceNow Security Operations Addon\" response action \"Create Multiple ServiceNow Security Incidents\". The response action is expected to create a separate SIR ticket for each result returned by the correlation search—and it does. However, the issue is that all the tickets created from a given correlation search run contain the description from only the first result. As a result, the customer ends up with multiple identical tickets, and the information from the remaining correlation search results is lost. Please see the attached screenshots. Steps to Reproduce: Create a correlation search in Splunk Enterprise Security that produces multiple rows per run. Use the add-on \"ServiceNow Security Operations Addon\" response action \"Create Multiple ServiceNow Security Incidents\" to create multiple SIR tickets. Check the content of the tickets created. For more details see the attached files. Investigation Summary: ServiceNow Security Operations Addon Debugging (log level set to Debug) The latest plugin version 1.40.3. https://splunkbase.splunk.com/app/3921 The following list demonstrates a list of duplicates with the same description: https://nn.service-now.com/now/nav/ui/classic/params/target/sn_si_incident_list.do%3Fsysparm_query%3Dshort_descriptionLIKEDuplication%2520test%26sysparm_first_row%3D1%26sysparm_view%3D Posted a message in a teamchat : https://teams.microsoft.com/l/message/19:dxg_nLZcz45megxv6a4wO1WyXZgt9V0VmU5U0C0Ao6g1@thread.tacv2/1748935710548?tenantId=8bcff170-9979-491e-8683-d8ced0850bad&groupId=9ea2a45b-7706-4f7e-8abc-8ec05ba4144d&parentMessageId=1748935710548&teamName=sir_swat-ServiceNow&channelName=General&createdTime=1748935710548 Attached the splunk log for this incident - SIR0052016 Knowledge Articles Researched: https://splunkbase.splunk.com/app/3921 https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-sir/secops-integration-splunk-addon/concept/secops-integration-with-splunk.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1111464",
      "parent_case": "CS8310051",
      "subject": "IBM QRadar Field Translation logic/code for Company field in IBM QRadar Profile: (CASOC Infrastructure - Primary) NOT working as expected",
      "description": "<<---INT Task Template (Do Not Remove)-->> Issue Definition: The customer is reporting that with the IBM QRadar SecOps integration, when getting new offenses and using Field Translation for the Company field, if the Data doesn't match any of the companies configured in the Field Translation script, it should default to CASOC, but instead, it defaults to AKAMAI, and they want to know why this is happening. Affected instance(s): ibmcasocprod Is it Sub-prod or Prod? PROD Affected version(s): Xanadu Patch 7a Upgraded From: Xanadu Patch 7 SNC access: NO What Product/Service is affected?: Security Incident Response with IBM QRadar Does this case fall under Squad A/B/D? Squad A Steps to Reproduce: • SIR0039972 and SIR0039971 was mapped to Akamai no CASOC but code is configured to default to CASOC domain if no mapping or match is found • Access IBM QRadar and generate offenses that should fall into \"CASOC\" (i.e., offenses where sourceValue doesn't match any predefined company in companyMapping). • Verify the assigned value of the company field. Observe whether offenses are mapped to \"CASOC\" or \"AKAMAI\". • Check the extracted value from sourceValue using a debug statement: console.log(\"Extracted value: \", sourceValue.split(':',1)[0]); This will help determine if the correct portion of sourceValue is being used. • If logging shows that the extracted value does not exist in companyMapping, confirm whether \"CASOC\" is applied correctly. • Validate if unexpected values (like \"Firewall Deny\") are causing fallback to \"AKAMAI\". Expected Behavior: If sourceValue matches a key in companyMapping, the corresponding mapped value should be assigned to destinationValue. If sourceValue does not match any keys in companyMapping, destinationValue should default to \"CASOC\". Actual Behavior: When there is no match found, offenses are unexpectedly defaulting to \"AKAMAI\" instead of \"CASOC\", despite the code modification. Is the Issue Reproducible out of the box? [YES/NO/NOT APPLICABLE] ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ Investigation Summary: The field translation logic in IBM QRadar Profile: CASOC Infrastructure - Primary is not functioning as expected. Specifically, offenses that should default to \"CASOC\" when there is no match in the predefined mapping dictionary are incorrectly being assigned to \"AKAMAI\", despite modifications made to the code. The issue occurs when the Comapany field for offenses is populated based on the mapping logic, where sourceValue is used to look up predefined company mappings. If no match is found, the fallback should be \"CASOC\", yet offenses are unexpectedly defaulting to \"AKAMAI\". - \"CASOC Infrastructure - Primary\" Profile: https://ibmcasocprod.service-now.com/nav_to.do?uri=sn_sec_qradar_profile.do?sys_id=e5a5b74987572d14c02c848e8bbb3521 - Example record SIR0039981 history: https://ibmcasocprod.service-now.com/now/nav/ui/classic/params/target/sys_history_set.do%3Fsys_id%3D6439d89e33752a90384693123d5c7bbe - Offense ID 10332 related to SIR0039981 record in \"sn_sec_qradar_offense_import\" table: https://ibmcasocprod.service-now.com/nav_to.do?uri=sn_sec_qradar_offense_import.do?sys_id=eb1379a533bd6290384693123d5c7bb9 - Record of \"sn_sec_qradar_offense_to_task\" related to SIR0039981: https://ibmcasocprod.service-now.com/nav_to.do?uri=sn_sec_qradar_offense_to_task.do?sys_id=bf13f9a533bd6290384693123d5c7b33 - In the History of the SIR records, we can see when the Company field is defaulted to AKAMAI instead of CASOC by the system. This should not be happening and it should be CASOC. - Translation map where company field is mapped: https://ibmcasocprod.service-now.com/nav_to.do?uri=sn_sec_qradar_field_translation.do?sys_id=ecdc809887fe6110c02c848e8bbb3572 - Code Used: var companyMapping = { \"Broadridge Financial\": \"BROADRIDGE\", \"Sun Life Financial\": \"SUNLIFE\", \"Manulife Financial Corporation\": \"MANULIFE\", \"Follett Corporation\": \"FOLLET\", \"Previred\": \"PREVIRED\", \"State of Michigan\": \"STATEOFMI\", \"MLSE\": \"MLSE\", \"CASOC\": \"CASOC\", \"CASoC\": \"CASOC\", \"ISM\": \"ISM\", \"SIS\": \"SIS\", \"GOM\": \"GOM\", \"Akamai\": \"AKAMAI\", \"AKAMAI\": \"AKAMAI\", \"MPI\": \"MPI\", \"Custom Akamai Kona Event\": \"AKAMAI\", \"Alberta Health\": \"Alberta Health\", \"CENOVUS\": \"CENOVUS\", \"Cenovus\": \"CENOVUS\" }; // Mapping logic: Extract first part of sourceValue before lookup destinationValue = companyMapping[sourceValue.split(':',1)[0]] || \"CASOC\"; Syslog logs when SIR0039981 record was created: https://ibmcasocprod.service-now.com/syslog_list.do?sysparm_query=sys_created_onBETWEENjavascript:gs.dateGenerate(%272025-05-28%27%2C%2716:53:00%27)@javascript:gs.dateGenerate(%272025-05-28%27%2C%2716:53:59%27)%5Econtext_mapLIKE26133da533bd%5EmessageLIKEcompany&sysparm_first_row=1&sysparm_view=&sysparm_choice_query_raw=&sysparm_list_header_search=true Splunk logs show the following message: 2025-05-28 13:53:42 (585) worker.0 worker.0 txid=26133da533bd SSI_98e56753c75500102450ed6c95c26076 DEBUG DEBUG: sn_sec_qradar (IBMQRadarPreviewOffense): Invoking _performPreviewFieldMapping with securityIncident: [object Object] inputs:AKAMAI company Company Excessive Firewall Denies Between Hosts containing Firewall Deny Splunk logs: https://splunk.servicenow.net/en-US/app/search/search?earliest=1748462400&latest=1748466000&q=search%20instance%3Dibmcasocprod%20%7C%20search%2026133da533bd%20AND%20company&display.page.search.mode=verbose&dispatch.sample_ratio=1&sid=1748645196.137489_BE372C54-E096-4DFB-B8BF-A6BE81F7D40F Above error message is generated in \"IBMQRadarPreviewOffense\" Script include > \"_performPreviewFieldMapping()\" function > line 78: - https://ibmcasocprod.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=98e56753c75500102450ed6c95c26076 Examples of SIR records with this issue: • SIR0039981 • SIR0039982 • SIR0039983 • SIR0039985 • SIR0039986 • SIR0039988 • SIR0039989 Customer implemented a workaround based on mapping correct company field value based on Domain ID and noticed same issue. Logic/code being ignored and 'AKAMAI' value is being passed/inputted into company field. Affected SIR tasks/records with this workaround: - SIR0040228 10,438 AKAMAI IBM/CASOC/AKAMAI - SIR0040227 10,437 AKAMAI IBM/CASOC/AKAMAI See code: /* domain ID's CASOC = 1 IGS = 3 Alberta Health = 4 */ var companyMapping = { \"Broadridge Financial\": \"BROADRIDGE\", \"Sun Life Financial\":\"SUNLIFE\", \"Manulife Financial Corporation\":\"MANULIFE\", \"Follett Corporation\":\"FOLLET\", \"Previred\":\"PREVIRED\", \"State of Michigan\":\"STATEOFMI\", \"MLSE\":\"MLSE\", \"CASOC\":\"CASOC\", \"CASoC\":\"CASOC\", \"ISM\":\"ISM\", \"SIS\":\"SIS\", \"GOM\":\"GOM\", \"Akamai\":\"AKAMAI\", \"AKAMAI\":\"AKAMAI\", \"MPI\":\"MPI\", \"Custom Akamai Kona Event\":\"AKAMAI\", \"Alberta Health\":\"Alberta Health\", \"CENOVUS\":\"CENOVUS\", \"Cenovus\":\"CENOVUS\", \"1\":\"CASOC\", \"3\":\"AKAMAI\", \"4\":\"Alberta Health\", }; destinationValue = companyMapping[sourceValue.split(':',1)[0]] || \"CASOC\"; QUESTIONS - Why is AKAMI being passed in the \"IBMQRadarPreviewOffense\" script? Where is it getting that AKAMAI value? - Why are SIR items defaulting to AKAMAI, if in the Field Mapping of the Profile, CASOC is configured, not AKAMAI? - They have something similar with the \"Assignment Group\" field and it works with that field, but not with Company. ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ Similar KBs/Cases/Tasks/PRB searched: https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-sir/secops-integration-qradar-ibm/concept/ibm-qradar-mapping-process.html Was this case/issue discussed in a war room? NOT DISCUSSED Was the tag \"TZR: US EST\" added? NO TZR NEEDED What is the Impact to the customer? Any deadlines/Urgency? P3, this is high priority for them",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1112071",
      "parent_case": "CS8245874",
      "subject": "Multiple Capability Implementation Executions created under Implementation Execution",
      "description": "------------------------------------​ Please conduct testing on anzbankdev instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No​ ------------------------------------​ Assistance Requested: Troubleshooting Assistance requested​ Affected instance(s): anzbankdev ​ Affected version(s): Yokohama Patch 3​ Issue Definition: Multiple Capability Implementation Executions created under Implementation Execution Steps to Reproduce: 1. Hop on to anzbankdev 2. create an SIR record with CI as cpc-augswx1vs92 3. Fill the mandatory fields and save the SIR Record 4. You will see Sub flow \"Security Operations Integration - Run Additional Actions - V1\" gets executed 5. On the sub flow if you see the step \"Create Implementation\" and Execution record is created 6. If you open the execution record we see that multiple Capability Implementation Executions are created Investigation Summary: ​ 1. When we see how the records are created in Execution from logs we see that flow is triggering Example Execution: https://anzbankdev.service-now.com/sn_sec_cmn_capability_execution.do?sys_id=83f0f58bc371a25045b829d9d00131a0&sysparm_record_target=sn_sec_cmn_capability_execution&sysparm_record_row=4&sysparm_record_rows=74356&sysparm_record_list=ORDERBYDESCsys_created_on%5EORDERBYsys_id 2. We see that flow Security Operations Integration - Run Additional Actions - V1 is responsible to create the Executions Security Operations Integration - Run Additional Actions - V1 3. From the flow executions we see that in step 2 that implementation is getting created and from flow we see that only one execution is getting created https://anzbankdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3D00398d54bc8a6610ef22fc87c4c26e83 4. The source for the sub flow is a custom flow https://anzbankdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_hub_flow%26sysId%3Dc802f88b33330a5071f48e123d5c7b11 5. We have checked the flow and sub flow executions as well to see if it has been triggered multiple times but it just got triggered once 6. We have also reviewed the action Create Implementations in subflow and see that the limit is passed as 1 and not multiple https://anzbankdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_hub_action_type_definition%26sysId%3D620267030bd0001099b8ea7885673a8c We would need your assistance to find why multiple executions has created",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1111193",
      "parent_case": "CS8243982",
      "subject": "Help determine why DLP records are taking extended time to load in workspace. (Issue does not occur in platform record)",
      "description": "------------------------------------ Please conduct testing on hancockwhitneytest instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes --> Assign task and request, we will get SNC access ------------------------------------ Assistance Requested: =================== Help determine why DLP records are taking extended time to load in workspace. (Issue does not occur in platform record) Affected instance(s): hancockwhitneytest Affected version(s): Xanadu Patch 7 Issue Definition: ============== In workspace, DLP records are taking 15-30+ seconds to load. Issue does not happen in platform Steps to Reproduce: ================= 1. Impersonate Hickox, Clint (A110566) 2. Navigate to https://hancockwhitneytest.service-now.com/now/dlp/list [ Note: Workspace is 'DLP IR Enduser Workspace'] 3. Click DLP0083207 and wait a long time https://hancockwhitneydev.service-now.com/sn_dlir_incident.do?sys_id=f511f4f71b31aed0c6fb0e13604bcb24&sysparm_view=Endpoint&sysparm_domain=null&sysparm_domain_scope=null&sysparm_nostack=yes Investigation Summary: ==================== -- Asking customer to update sn_si and sn_dlir (waiting on response there), We noticed that the plugin store apps are slightly out of date -- Customer had to provide new examples but they autoclose, thus, we re-opened the following DLP record you can use: https://hancockwhitneydev.service-now.com/sn_dlir_incident.do?sys_id=f511f4f71b31aed0c6fb0e13604bcb24&sysparm_view=Endpoint&sysparm_domain=null&sysparm_domain_scope=null&sysparm_nostack=yes the newest examples are: DLP0106034 DLP0106037 DLP0106038 But again, they might autoclose after a day -- Logs not showing anything that stands out as a cause -- Performance noted that no slow queries but see ACLs as maybe cause: https://secsplunk.servicenow.net/en-US/app/search/search?earliest=1747946730&latest=1747947630&q=search%20sourcetype%3Dappnode_localhost_log%20index%3Dappnode_log_phx_sub%20instance%3Dhancockwhitneytest%20node%3Dhancockwhitneytest018%20%22txid%3D9c18fa271be1%22%20%7C%20reverse&display.page.search.mode=fast&dispatch.sample_ratio=1&sid=1747947830.222186_96D7F2E5-86B6-4045-8120-80020393DFA3 (will post logs above) -- Network shows nothing to note on delay, xmlhttp.do shows nothing we can consider an issue",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1110781",
      "parent_case": "CS8321785",
      "subject": "How to configure Security Incident Response integration with AWS SecurityHub in the domain separated org?",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> Assistance Requested: Hi team, I couldn't find any documentation about this.. Maybe can we ask the dev team the steps to configure and its support level based on the below doc? (Basic? Standard??) https://www.servicenow.com/docs/bundle/xanadu-platform-security/page/administer/company-and-domain-separation/reference/domain-separated-apps.html https://www.servicenow.com/docs/bundle/washingtondc-security-management/page/product/security-incident-response/concept/domain-separation-security-incident-response.html Affected instance(s): n/a Affected version(s): Xanadu, Yokohama Issue Definition: The customer wants to configure Security Incident Response integration with AWS SecurityHub with the domain separation. However, there's no documentation like Microsoft Azure Sentinel integration as below - what's support level of the domain separation and how can the customer configure it? https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/secops-integration-sir/secops-integration-ms-azure-sentinel/concept/azure-sentinel-domain-separation.html Steps to Reproduce: n/a Investigation Summary: - Security Incident Response integration with AWS SecurityHub https://store.servicenow.com/store/app/d049a7ae1be06a50a85b16db234bcb7f - Domain separation should be supported based on the below KB, but the support level and the configuration steps are not described. https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1705017 Knowledge Articles Researched: https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1705017 https://www.servicenow.com/docs/bundle/washingtondc-security-management/page/product/security-incident-response/concept/domain-separation-security-incident-response.html https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/secops-integration-sir/secops-integration-ms-azure-sentinel/concept/azure-sentinel-domain-separation.html https://www.servicenow.com/docs/bundle/xanadu-platform-security/page/administer/company-and-domain-separation/reference/domain-separated-apps.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1108747",
      "parent_case": "CS8303495",
      "subject": "ServiceNow Splunk ES integration is queueing up Splunk platform",
      "description": "------------------------------------ Please conduct testing on shell2 instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes/No ------------------------------------ Assistance Requested: ServiceNow Splunk ES integration is queueing up Splunk platform Affected instance(s): shell2 Affected version(s): Yokohama Patch 3 Issue Definition: ServiceNow Splunk ES integration is queueing up Splunk platform Investigation Summary: 1. Customer mentioned that ServiceNow is sending a lot of requests to Splunk and these queries have led to huge queueing on Splunk, and the platform is unavailable for a lot of users on Splunk. 2. They requested if there is any way that they can escalate only \"Critical\" Urgency notables as Security Incident, then send the filter condition \"urgency=critical\" in the search query to Splunk. This will reduce the load on Splunk as well, as it will avoid Splunk processing useless data. 3. We reviewed the script includes related to splunk and could see that the following script include \"SplunkESEventIngestionQueryAbstract\" builds the query. https://shell2.service-now.com/sys_script_include.do?sys_id=3067db120fa23300012db8a276767e90 4. Had a call with the customer and they mentioned that where 648 correlation rules are being queried every 5 minutes. Their splunk admin explained that each rule generates a separate search query, with only 50 concurrent searches allowed while others are queued. They planed to reduce the batch size from 40 to 20 correlation rules and is considering creating separate profiles for frequent versus infrequent rules with different polling intervals. Their splunk admin will assess the impact of queued searches on the platform and explore the possibility of increasing concurrent search limits, though this requires careful evaluation of CPU resource consumption. 5. Customer again updated that With a polling time of 5 minutes, so, the queries should have a time difference of 5 minutes. Apparently, that is not the case. Seems like we are sending a lot more queries. They also have a couple of proposed solutions that they can think about implementing and requested for a call. 6. They also mentioned that they have following observations there are two search types: \"incident_review_lookup\" and \"notable fetch\". The notable fetch search is batched. and is run 754 times in an hour. Whereas the incident_review_lookup is not batched and it run very frequently. 22094 times in an hour. As per my understanding of the integration, there should be only one search type i.e. the \"notable fetch\" batch search to fetch the notables. What is the purpose of \"incident_review_lookup\" search?",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1108975",
      "parent_case": "CS8320019",
      "subject": "IPs submitted via the \"Security Operations Integration - Block Request\" workflow are not being added to the \"sn_sec_panfw_edl_entry\" table",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on \"ouium\" instance The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Need help to identify why the IPs submitted via the \"Security Operations Integration - Block Request\" workflow are not being added to the \"sn_sec_panfw_edl_entry\" table or the firewall's EDL, despite the workflow completing with a success status. Affected instance(s): ouium Issue Definition: The subflow Security Operations Integration - Block Request is triggered to block observables. It executes without errors, and the workflow state is Finished. However, no record is created in sn_sec_panfw_edl_entry Plugin: Palo Alto Networks NGFW Integration Version: v10.3.2 https://ouium.service-now.com/now/app-manager/home/app/id/51f717349f83120034c6b6a0942e7075/v/10.3.2/details Steps to Reproduce: 1. Trigger the subflow: Security Operations Integration - Block Request 2. Pass in an observable IP (example: 185.199.108.153) View the execution context: https://ouium.service-now.com/wf_context.do?sys_id=15743a1f33bda210c26627cb9d5c7bbe 3. Example Flow designer: ====== https://ouium.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3Dcd743a1faebda2104146819cd0e22988 ========= Investigation Summary: ========== The script used in the workflow is below: run(); function run() { activity.result = 'failure'; var utils = new sn_sec_panfw.PANFWEDLIntegrationUtils(); var edlId = utils.getBlockListIdByImpl(workflow.inputs.implementation_id + ''); if (gs.nil(edlId)) return; var obsArrStr = workflow.inputs.observables + ''; var obsArr = new global.JSON().decode(obsArrStr); var obsId = utils.getObservableIdByValue(obsArr[0]['value'], obsArr[0]['type']); var integrationExeId = workflow.inputs.parent_capability_execution_id + ''; utils.createBlockListEntry(obsId, edlId, 'requested', 'add', integrationExeId); activity.result = 'success'; } Not sure if it is silently failing with in createBlockListEntry() method of \"PANFWEDLIntegrationUtils\" script include silently",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1105231",
      "parent_case": "CS8305975",
      "subject": "Users with only the snc_internal role cannot submit the \"Report Phish Email\" record producer after Yokohama upgrade",
      "description": "This issue is reproduced in OOB below. Please use this emp instance for the test. https://empkazd8.service-now.com/ Yokohama Patch 2 Security Incident Response [sn_si] - 13.6.6 (Latest) Assistance Requested: Troubleshooting Assistance​ Issue Definition: After upgrading to Yokohama, users who only have the `snc_internal` role are unable to submit the \"Report Phish Email\" record producer. The following error message is displayed: \"You can report only one phishing email at a time in .eml format.\" This behavior also occurs in an Out-of-Box (OOB) environment. Customer inquiries are below. - Is this the expected behavior? - Is it assumed that all users reporting phishing emails must have the `sn_si.basic` role? - Is there any way for general users without adding any roles to report phishing emails? Steps to Reproduce: 1. Create user who has snc_internal only. CS8305975 https://empkazd8.service-now.com/nav_to.do?uri=sys_user.do?sys_id=d97ae6e547f5a2107045d902516d43fb 2. In the portal, search for \"Report Phish Email\". Example: /esc https://empkazd8.service-now.com/esc?id=sc_cat_item&sys_id=6f839f7fb3a33300ed7fc9c316a8dc5e 3. Impersonate to above user. 4. Upload a file in `.eml` format and click the Submit button. Investigation Summary: ​ 1. The issue is caused by a role check in the `ingestEMLUpload` function within the Script Include `URPUtil`, which is invoked by the \"Report Phish Email\" record producer. Record Producer - Report Phish Email https://empkazd8.service-now.com/nav_to.do?uri=sc_cat_item_producer.do?sys_id=6f839f7fb3a33300ed7fc9c316a8dc5e Script Include - URPUtil https://empkazd8.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=617ca3c4c70333008ff19e0703c2601a The relevant code snippet is: SN_SI_BASIC_ROLE: 'sn_si.basic', SN_SEC_CMN_READ_ROLE: 'sn_sec_cmn.read', ........... if(!gs.hasRole(this.SN_SI_BASIC_ROLE) && !gs.hasRole(this.SN_SEC_CMN_READ_ROLE)) { gs.error(\"Minimum required role is missing.\"); return result; } 3. This logic was introduced as part of STRY58192812. https://code.devsnc.com/dev/app-secops-common/blame/30874a5610a67dc10a456165b8ccf32887fff4f5/src/main/plugins/com.snc.security_support.common/update/sys_script_include_617ca3c4c70333008ff19e0703c2601a.xml 4. The official product documentation does not mention the usage requirements for the \"Report Phish Email\" record producer. Knowledge Articles Researched:​ No KB has been reported yet.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1096961",
      "parent_case": "CS8279486",
      "subject": "IBM QRadar Rules Retrieval flow is failing if ALL is not selected for Supported Application and Mid-Server",
      "description": "------------------------------------ Please conduct testing on gmdev instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes ------------------------------------ Assistance Requested: IBM QRadar Rules Retrieval flow is failing if ALL is not selected for Supported Application and Mid-Server, is there a way to make it work without listed ALL as Supported Application? Looks like this is a Java Error. Even with the Supported Application listed, it fails. Only succeeds if \"ALL\" is listed. Affected instance(s): gmdev Affected version(s): Xanadu Patch 7a Issue Definition: IBM QRadar Rules Retrieval flow is failing if ALL is not selected for Supported Application and Mid-Server Steps to Reproduce: Success: https://gmdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3D647baa2e3ea56e10bc976f0f8bdec639 Failure: https://gmdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3Df83beaeaa5a56e10f9eefa41610a9bec Investigation Summary: When all is added: Success: https://gmdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3D647baa2e3ea56e10bc976f0f8bdec639 When all is removed: Failure: https://gmdev.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3Df83beaeaa5a56e10f9eefa41610a9bec Mid Server: https://gmdev.service-now.com/ecc_agent.do?sys_id=8573348c38e98210f728ccd05ae95b11&sysparm_view=discovery Documentation: https://www.servicenow.com/docs/bundle/washingtondc-servicenow-platform/page/product/mid-server/task/t_SpecifyMIDServerApplications.html Error: *** ERROR *** Unable to find any validated MID Server based on status (up), and application: ALL: ********* Logs Below ********** Knowledge Articles Researched: https://www.servicenow.com/docs/bundle/washingtondc-servicenow-platform/page/product/mid-server/task/t_SpecifyMIDServerApplications.html https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB0955194",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1105372",
      "parent_case": "CS8310832",
      "subject": "Threat intelligence capability executions are getting queued",
      "description": "------------------------------------ Please conduct testing on zeisstest instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes - See SHN ------------------------------------ ============================ Assistance Requested: ============================ Please advise on the cause of the slowness and approach to resolve this. Affected instance(s): zeisstest Affected version(s): Xanadu ============================ Issue Definition: ============================ Slow processing of the Threat intelligence capability executions - discovered during UAT Sample records: EX0073037 - Created at 2025-05-28 23:51:32 & Execution Completed at 2025-05-29 07:10:52 EX0073010 - Created at 2025-05-28 23:51:32 & Execution Completed at 2025-05-29 06:30:01 EX0074449 - Created at 2025-05-29 01:50:13 & Execution Completed at 2025-05-29 07:48:40 ============================ Steps to Reproduce: ============================ N/A ============================ Investigation Summary: ​ ============================ > I reviewed shared records: - the flow processing was quick - the flow took about 30 seconds to complete - there were about 48 000 records in sn_sec_cmn_capability_implementation_execution created yesterday - some records created around the same time were processed quicker (not as quick as currently seen) > The scheduled job that processes the records runs every 10 seconds Process Capability Implementations https://zeisstest.service-now.com/nav_to.do?uri=sysauto_script.do?sys_id=bb1b17570b90001099b8ea7885673a07 > Currently I am not able to see the slowness - the records are being processed under 5 minutes from creation - with 10 records being queued Examples: https://zeisstest.service-now.com/nav_to.do?uri=sn_sec_cmn_capability_implementation_execution.do?sys_id=b5d638b593f9aed05b75bf3a6aba10a0 https://zeisstest.service-now.com/nav_to.do?uri=sn_sec_cmn_capability_implementation_execution.do?sys_id=30d4f0b993b9aed05b75bf3a6aba1031 > Checked old records - did not find a definitive solution https://support.servicenow.com/sn_customerservice_task_list.do?sysparm_query=descriptionLIKEsn_sec_cmn_capability_execution&sysparm_view= CSTASK881290/CSTASK887638 ============================ Knowledge Articles Researched: ============================ Not found",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1106646",
      "parent_case": "CS8275215",
      "subject": "Error when generating PIR",
      "description": "------------------------------------ Please conduct testing on nmldev instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: ====================== -Customer has some SecOps SIR incidents that are missing the Post Incident Review report PDFs are not getting generated. -In the sys log entry for when the failure occurs you see the below error message. Evaluator.evaluateString() problem: java.lang.IllegalArgumentException: No enum constant org.mozilla.javascript.TopLevel.NativeErrors.TimeoutError: java.base/java.lang.Enum.valueOf(Enum.java:273) org.mozilla.javascript.TopLevel$NativeErrors.valueOf(TopLevel.java:66) org.mozilla.javascript.ScriptRuntime.newCatchScope(ScriptRuntime.java:4589) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:2187) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_include_4d786e6ec74c2010603cb51927c260c6_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_include_eb14110ac7571010603cb51927c26058_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_include_eb14110ac7571010603cb51927c26058_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_include_eb14110ac7571010603cb51927c26058_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_include_eb14110ac7571010603cb51927c26058_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_script_2237f329df10220068c32df36bf263b3_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ScriptRuntime.doCall2(ScriptRuntime.java:3089) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2998) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$exec$1(InterpretedFunction.java:178) com.glide.caller.gen.sys_script_2237f329df10220068c32df36bf263b3_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.exec(InterpretedFunction.java:177) com.glide.script.ScriptCompiler.executeAndPublishMetric(ScriptCompiler.java:77) com.glide.script.ScriptEvaluator.execute(ScriptEvaluator.java:439) com.glide.script.ScriptEvaluator.evaluate(ScriptEvaluator.java:219) com.glide.script.fencing.GlideScopedEvaluator.evaluateScript(GlideScopedEvaluator.java:376) com.glide.script.BusinessRule.runScript(BusinessRule.java:468) com.glide.script.BusinessRule.runSyncBusinessRule(BusinessRule.java:336) com.glide.script.BusinessRule.runBusinessRule(BusinessRule.java:223) com.glide.script.BusinessRule.run(BusinessRule.java:199) com.glide.script.GlideRecordBusinessRules.run(GlideRecordBusinessRules.java:248) com.glide.script.GlideRecord.runScripts(GlideRecord.java:1510) com.glide.script.GlideRecord.runScriptsAndEngines(GlideRecord.java:1446) com.glide.script.GlideRecord.postChange(GlideRecord.java:5515) com.glide.script.GlideRecord.postUpdate(GlideRecord.java:5488) com.glide.script.GlideRecord.updateWithoutResettingOperation(GlideRecord.java:5013) com.glide.script.GlideRecord.update(GlideRecord.java:4877) com.glide.script.GlideRecord.jsFunction_update(GlideRecord.java:4657) com.glide.script.fencing.ScopedGlideRecord.jsFunction_update(ScopedGlideRecord.java:245) jdk.internal.reflect.GeneratedMethodAccessor150.invoke(Unknown Source) java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) java.base/java.lang.reflect.Method.invoke(Method.java:569) org.mozilla.javascript.MemberBox.invoke(MemberBox.java:236) org.mozilla.javascript.FunctionObject.doInvoke(FunctionObject.java:674) org.mozilla.javascript.FunctionObject.call(FunctionObject.java:603) org.mozilla.javascript.ScriptRuntime.doCall(ScriptRuntime.java:2988) org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1928) org.mozilla.javascript.Interpreter.interpret(Interpreter.java:1112) org.mozilla.javascript.InterpretedFunction.lambda$call$0(InterpretedFunction.java:161) com.glide.caller.gen.sys_ui_action_e26de2451b6b68503a0edb58b04bcbd3_script.call(Unknown Source) com.glide.script.ScriptCaller.call(ScriptCaller.java:22) org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:160) org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:719) org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:4412) org.mozilla.javascript.InterpretedFunction.exec(InterpretedFunction.java:174) com.glide.script.ScriptCompiler.executeAndPublishMetric(ScriptCompiler.java:77) com.glide.script.ScriptEvaluator.execute(ScriptEvaluator.java:439) com.glide.script.ScriptEvaluator.evaluate(ScriptEvaluator.java:219) com.glide.script.GlideRhinoHelper.evaluateAsString(GlideRhinoHelper.java:164) com.glide.script.ActionScript.conditionalEval(ActionScript.java:110) com.glide.script.ActionScript.execute(ActionScript.java:95) com.glide.script.ActionScriptProcessor.processScript(ActionScriptProcessor.java:233) com.glide.script.Action.process(Action.java:117) com.glide.ui.RedirectTransaction.invokeAction(RedirectTransaction.java:552) com.glide.ui.RedirectTransaction.handleActions(RedirectTransaction.java:508) com.glide.ui.RedirectTransaction.inboundActions(RedirectTransaction.java:344) com.glide.ui.RedirectTransaction.process(RedirectTransaction.java:207) com.glide.ui.GlideServletUITransaction.process(GlideServletUITransaction.java:124) com.glide.processors.AProcessor.runProcessor(AProcessor.java:779) com.glide.processors.AProcessor.processTransaction(AProcessor.java:326) com.glide.processors.ProcessorRegistry.process0(ProcessorRegistry.java:187) com.glide.processors.ProcessorRegistry.process(ProcessorRegistry.java:175) com.glide.ui.GlideServletTransaction.process(GlideServletTransaction.java:58) com.glide.sys.Transaction.run(Transaction.java:2815) com.glide.ui.HTTPTransaction.run(HTTPTransaction.java:35) java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) java.base/java.lang.Thread.run(Thread.java:840) -Customer stated the issue only happens with SIR record has security request associated to the record. -Customer does has a custom flow on how they are creating security reqeust records. Here is the zoom recording: ============================= -https://servicenow.zoom.us/rec/play/wXqRHf3RvbVNRTtd_Onc8HD9GmX6sm1tlDuA9oLSB-APW7vXUoPURI_ibqsF_tvkHBje3yj-N9YDbjOK.SrOyej541cSHW7uP?eagerLoadZvaPages=sidemenu.billing.plan_management&accessLevel=meeting&canPlayFromShare=true&from=share_recording_detail&continueMode=true&componentName=rec-play&originRequestUrl=https%3A%2F%2Fservicenow.zoom.us%2Frec%2Fshare%2FZ2pXAQVFPyCAbHl_BIQdl0xGxGNjuubNikvbyoBOBWMD1qO8RC2eLdzKL8kJr7Mz.lKCbH1e_Oypn7GnB Affected instance(s): nmldev Affected version(s): __VERSION_HERE__ Steps to Reproduce: =================== -Navigate to this example record :https://nmldev.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=3635849feb6d2294455ff5dabad0cd2d -Change the Report template to \" SecOps Security incident\" -Click on Configure/Preview You can also replicate the error message belwo running the below script. var grSIRInc = new GlideRecord(\"sn_si_incident\"); if (grSIRInc.get(\"0f591e7c83d1ea90684e7d447daad319\")) { var template = new sn_si.ReportConfigUtil().getApplicablePrimaryTemplate(grSIRInc); var tempGrPrimary = new GlideRecord('sn_si_report_template'); tempGrPrimary.addQuery('sys_id', template.value); tempGrPrimary.query(); if (tempGrPrimary.next()) { var config; var configGr = new GlideRecord(\"sn_si_report_instance\"); configGr.addQuery(\"report_template\", tempGrPrimary.getUniqueValue()); configGr.addQuery(\"security_incident\", grSIRInc.getUniqueValue()); configGr.query(); if (configGr.next()) config = configGr; var isCloserPdf = true; var attachmentId = new sn_si.ReportTemplateUtil().generateAndAttachReportPDF(grSIRInc, tempGrPrimary.getUniqueValue(), config, isCloserPdf); } } Investigation Summary: ======================= -Tried debugging the following script include but unable to identifiy why the SIR records are failing when security request records are associated. Next step: =========== -Reaching out to the SIR dev for further assistance on identifing the root cause behind the error message that is getting generated.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1106092",
      "parent_case": "CS8072152",
      "subject": "PRB1871374-Closed Security Incident creates multiple draft emails each time it is accessed",
      "description": "------------------------------------ Please conduct testing on btmutest instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: ====================== -SIR Issue : Closed Security Incident creates multiple draft emails each time it is accessed. Affected instance(s): btmutest Affected version(s): Washington DC Patch 9b Steps to Reproduce: ==================== -Login as a Security Incident Analyst (Joseph Seng Open SIR Workspace Go to the Lists and access one of the closed SI. Click the Activity Stream icon on the right. It shows a draft email being composed. If you close that SI and access it again, it opens another draft email. eg : SIR0010002 currently has 3 draft emails. (Other Records tab -> Emails -> Draft Emails) Each time you access this record, the draft email count increases. Investigation Summary: ====================== -Below was provided to the customer • When a Closed Security Incident (SIR) is accessed in the SIR Workspace, a new draft email is created under Emails > Draft Emails each time. • This behavior results in multiple draft emails accumulating, even if no email was manually composed. Cause: • The issue is caused by the UIB Component Activity Stream used on the SIR Record page. • This component has an inbuilt feature that triggers the Compose Email function each time the user switches to the Email tab. • It functions similarly to how a draft email is automatically created when starting a new email in other common email applications. • This behavior is Working as Expected based on the current configuration of the Activity Stream component. Resolution: • Since this is the expected behavior of the Activity Stream component, no fix is required. • To prevent unintended draft emails from accumulating, users should avoid switching to the Email tab unless they intend to send an email. • Alternatively, consider configuring the SIR Workspace to limit the automatic draft creation, if feasible. Next step: =========== -Reaching out to SIR dev to see if it is possible for customer to disable this feature in the UI builder . If so, what steps would the customer needs to take?",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1103895",
      "parent_case": "CS8305185",
      "subject": "Two demo data SLA definitions were added to the instance. Need help to determine how this happened.",
      "description": "------------------------------------​ Please conduct testing on pldtgroup instance only.​ (PROD instance) The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? Yes​ ------------------------------------​ Assistance Requested: Need assistance to figure out how demo data SLA definition showed up in production instance. Affected instance(s): pldtgroup​ Affected version(s): Yokohama patch 3​ Issue Definition: Customer upgraded to Yokohama patch 3 on the 18th and it looks like as part of this upgrade 2 SLA definitions coming from security incident response demo data got installed. https://pldtgroup.service-now.com/nav_to.do?uri=contract_sla.do?sys_id=03a06b5bff500200158bffffffffffb0 https://pldtgroup.service-now.com/nav_to.do?uri=contract_sla.do?sys_id=7ce06b5bff500200158bfffffffffff5 Steps to Reproduce: N/A. Investigation Summary: ​ 1. Found that both SLA definitions are demo data 2. Would not expect demo data to get loaded on an upgrade. 3. Please let me know if there is an easy way to see in the upgrade logs or node logs that it was the upgrade that loaded these SLA definitions. 4. Might also need help with the cleanup as customer claims some of these SLA breached and then updated the parent records so just deleting the SLA definitions and SLAs might not be enough",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1091990",
      "parent_case": "CS8252316",
      "subject": "Customer has reported that certain offense IDs for their Security Incident Responses are not generating SIR records",
      "description": "------------------------------------ Please DO NOT conduct testing on newyorklife instance! This is customer's PRODUCTION instance The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Affected instance(s): newyorklife Affected version(s): Xanadu Patch7 Assistance Requested: Hello Team, Please assist me to identify the cause of the following behavior Issue Definition: Customer has reported that certain offense IDs for their Security Incident Responses are not generating SIR records Steps to Reproduce: Review the SIR records not matching the reference numbers (offense IDs) bellow: https://newyorklife.service-now.com/sn_si_incident_list.do?sysparm_query=correlation_idIN203062%2C203063%2C203050%2C203052%2C203067%2C203068%2C203069%2C203072%2C203074%2C203077%2C203082&sysparm_view= 203062 203063 203050 203052 203067 203068 203069 203072 203074 203077 203082 Investigation Summary: - I had a call with the customer to review the issue and showed them that sometimes the Offenses in the inbound payload like in the bellow example are \"summarized\" or combined under one offense ID: https://newyorklife.service-now.com/nav_to.do?uri=sn_sec_qradar_offense_import.do?sys_id=836e311697dd2610cc51310f2153af3b - in the above example we can see the offense id 203050 in the payload and the main Offense ID on this record is set to 203153 which has a corresponding SIR record created: https://newyorklife.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=4f6e311697dd2610cc51310f2153af89 - on further review we have grabbed random Offence IDs from the same offense import record and searched for corresponding SIR records in the 'sn_si_incident' table and found most of them having a separate SIR So the question remains why the following offense IDs did not generate a SIR records on the instance: 203062 203063 203050 203052 203067 203068 203069 203072 203074 203077 203082 Please let me know if you will have need any additional information from me or the customer. Thank you in advance and best regards, Armen",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1103503",
      "parent_case": "CS8306378",
      "subject": "Sentinel integration Incidents are not getting processed from sn_sec_sentinel_incident_raw table into Security Incident Table.",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on edfenergypreprod The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes ------------------------------------ Assistance Requested: Sentinel integration Incidents are not getting processed from sn_sec_sentinel_incident_raw table into Security Incident Table. Affected instance(s): edfenergy, edfenergypreprod Affected version(s): Yokohama Patch 3 Issue Definition: Sentinel integration Incidents are not getting processed from sn_sec_sentinel_incident_raw table into Security Incident Steps to Reproduce: open the sn_sec_sentinel_incident_raw table and see the state. It was all working fine till 10:11am today No changes have been moved to prod today we tried disabling the profiles and renable it but didn't work profiles can be found in below link https://edfenergy.service-now.com/sn_sec_sentinel_incident_profile_list.do?sysparm_query=active%3Dtrue&sysparm_first_row=1&sysparm_view= Investigation Summary: - Connected with customer on over zoom meeting - There are 1302 records in the \"sn_sec_sentinel_raw\" table in Ready to process state. These records are in Ready to Process, so there is no Incident Action (INSERT or UPDATE) added. - Azure Sentinel Process Raw Data Scheduled is the job that queries the \"sn_sec_sentinel_raw\" table for records with the state \"Ready to Process\". - Checking the sn_sec_sentinel_raw. table, on 8:19 AM on May 19th was the first record stuck in Ready to Process - They did an Upgrade on the 17th, they did an update, and post upgrade on the 18th and 19th, they faced an issue, and they resolved it by removing a field from the Mapping Profile. -AzureSentinelProcessRawData Script include was modified and some lines were added to help moving those records in \"Ready to Process\" state to \"Processed\". This was suggested by DEV team and one of the lines added was: s.info(\"Skipping update as the Security Incident is closed: {0}\", incidentId);",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1100968",
      "parent_case": "CS8275580",
      "subject": "Sentinel mapping for reference field - Affected uer",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on l48dev instance only The customer has NOT authorized access/changes to other instance(s.) SNC Access Control?No ------------------------------------ Assistance Requested: Field Mapping for reference field ( Affected user ) is not working. Affected instance(s): l48dev Affected version(s): Yokohama Sentinel Plugin version: 11.0.24 Issue Definition: When we use Field mapping for affected user field with Account name in Sentinel it is not updating the field in target table if User name doesn't match in incoming payload. We had tried creating Transform script while mapping using using query on email address field https://l48dev.service-now.com/nav_to.do?uri=sn_sec_sentinel_field_translation.do?sys_id=4f4e60273be1a6544474ef0864e45a21 But transform Script is not working. The affected user records are empty on SIR table Customer has tried to achieve the Solution by customizing script include as below (Now reverted back to OOB) if (gs.nil(destTable) || destTable == \"sn_si_incident\") return result; // If so, prioritize search by unique ID result.isReferenceField = true; searchGr = new GlideRecord(destTable); if (searchGr.get(inputValue)) { result.refUniqueId = searchGr.getUniqueValue(); return result; } https://l48dev.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=af5d6db877132010b7c5cc1c9f5a99e6 Steps to Reproduce: Execute One time retrieval for below profile for last 6 hours And validate Affected user in SIR table https://l48dev.service-now.com/sn_sec_sentinel_incident_profile.do?sys_id=4f6c45583b256a904474ef0864e45a8e Investigation Summary: Enable Debug property and captured the complete payload Example raw record https://l48dev.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_raw.do?sys_id=470a307bfbe1aa503867f7e4aeefdc67 SIR record https://l48dev.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=b14ab0fb3bad6a544474ef0864e45ae3 Debug Logs https://l48dev.service-now.com/syslog_list.do?sysparm_query=sys_created_onBETWEENjavascript%3Ags.dateGenerate('2025-05-23'%2C'01%3A10%3A00')%40javascript%3Ags.dateGenerate('2025-05-23'%2C'01%3A20%3A59')%5Esource%3Dsn_sec_sentinel%5EmessageLIKE984b9b9f-387b-4b4d-b50f-677259fd3f9b&sysparm_view= Mail address is passed in input Script Invoking performFieldMapping inputs:org.mozilla.javascript.NativeArray@6a21b211 {\"u_name\":\"984b9b9f-387b-4b4d-b50f-677259fd3f9b\",\"u_properties_providername_\":\"Microsoft XDR\",\"u_properties_additionaldata_bookmarkscount_\":\"0\",\"sys_updated_on\":\"2025-05-23 06:15:59\",\"u_etag\":\"\\\"310056eb-0000-0100-0000-682fdbbc0000\\\"\",\"incident_raw\":\"{\\\"Incident\\\":{\\\"id\\\":{\\\"value\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Incidents/984b9b9f-387b-4b4d-b50f-677259fd3f9b\\\"},\\\"name\\\":{\\\"value\\\":\\\"984b9b9f-387b-4b4d-b50f-677259fd3f9b\\\"},\\\"etag\\\":{\\\"value\\\":\\\"\\\\\\\"310056eb-0000-0100-0000-682fdbbc0000\\\\\\\"\\\"},\\\"type\\\":{\\\"value\\\":\\\"Microsoft.SecurityInsights/Incidents\\\"},\\\"properties(title)\\\":{\\\"value\\\":\\\"Email reported by user as not junk\\\"},\\\"properties(severity)\\\":{\\\"value\\\":\\\"Low\\\"},\\\"properties(status)\\\":{\\\"value\\\":\\\"New\\\"},\\\"properties(owner(objectId))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(owner(email))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(owner(assignedTo))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(owner(userPrincipalName))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(owner(ownerType))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(labels(labelName))\\\":{\\\"value\\\":\\\"Playbook: Suspicious email activity\\\"},\\\"properties(labels(labelType))\\\":{\\\"value\\\":\\\"User\\\"},\\\"properties(firstActivityTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:16:00 UTC\\\"},\\\"properties(lastActivityTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:17:00 UTC\\\"},\\\"properties(lastModifiedTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:21:48 UTC\\\"},\\\"properties(createdTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:17:24 UTC\\\"},\\\"properties(incidentNumber)\\\":{\\\"value\\\":97645},\\\"properties(additionalData(alertsCount))\\\":{\\\"value\\\":1},\\\"properties(additionalData(bookmarksCount))\\\":{\\\"value\\\":0},\\\"properties(additionalData(commentsCount))\\\":{\\\"value\\\":0},\\\"properties(additionalData(alertProductNames))\\\":{\\\"value\\\":\\\"Office 365 Advanced Threat Protection\\\"},\\\"properties(additionalData(tactics))\\\":{\\\"value\\\":\\\"InitialAccess\\\"},\\\"properties(additionalData(techniques))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(additionalData(providerIncidentUrl))\\\":{\\\"value\\\":\\\"https://security.microsoft.com/incident2/87945/overview?tid=79c3fa05-64e6-40a0-882c-2cb7fb4923c0\\\"},\\\"properties(relatedAnalyticRuleIds)\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(incidentUrl)\\\":{\\\"value\\\":\\\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Incidents/984b9b9f-387b-4b4d-b50f-677259fd3f9b\\\"},\\\"properties(providerName)\\\":{\\\"value\\\":\\\"Microsoft XDR\\\"},\\\"properties(providerIncidentId)\\\":{\\\"value\\\":\\\"87945\\\"}},\\\"AccountEntity\\\":{\\\"id\\\":{\\\"value\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Entities/2214760d-1235-b025-b789-fed501ef66ea\\\"},\\\"name\\\":{\\\"value\\\":\\\"2214760d-1235-b025-b789-fed501ef66ea\\\"},\\\"type\\\":{\\\"value\\\":\\\"Microsoft.SecurityInsights/Entities\\\"},\\\"kind\\\":{\\\"value\\\":\\\"Account\\\"},\\\"properties(accountName)\\\":{\\\"value\\\":\\\"Melissa Taylor (Applied Consultants)\\\"},\\\"properties(ntDomain)\\\":{\\\"value\\\":\\\"AD\\\"},\\\"properties(upnSuffix)\\\":{\\\"value\\\":\\\"bpx.com\\\"},\\\"properties(sid)\\\":{\\\"value\\\":\\\"S-1-5-21-430581307-2389976785-778888075-54255\\\"},\\\"properties(aadTenantId)\\\":{\\\"value\\\":\\\"79c3fa05-64e6-40a0-882c-2cb7fb4923c0\\\"},\\\"properties(aadUserId)\\\":{\\\"value\\\":\\\"a3a48c57-fab4-4713-b3b6-509b879a87cf\\\"},\\\"properties(isDomainJoined)\\\":{\\\"value\\\":true},\\\"properties(displayName)\\\":{\\\"value\\\":\\\"Melissa Taylor (Applied Consultants)\\\"},\\\"properties(dnsDomain)\\\":{\\\"value\\\":\\\"AD.BPX.COM\\\"},\\\"properties(additionalData(State))\\\":{\\\"value\\\":\\\"Texas\\\"},\\\"properties(additionalData(City))\\\":{\\\"value\\\":\\\"Denver\\\"},\\\"properties(additionalData(UserPrincipalName))\\\":{\\\"value\\\":\\\"melissa.taylor@bpx.com\\\"},\\\"properties(additionalData(AliasNames))\\\":{\\\"value\\\":\\\"[\\\\\\\"Melissa Taylor (Applied Consultants)\\\\\\\",\\\\\\\"Melissa.Taylor\\\\\\\"]\\\"},\\\"properties(additionalData(AccountName))\\\":{\\\"value\\\":\\\"melissa.taylor\\\"},\\\"properties(additionalData(DomainName))\\\":{\\\"value\\\":\\\"ad.bpx.com\\\"},\\\"properties(additionalData(Sources))\\\":{\\\"value\\\":\\\"[\\\\\\\"AzureActiveDirectory\\\\\\\"]\\\"},\\\"properties(additionalData(Department))\\\":{\\\"value\\\":\\\"P&O BPX - Midstream\\\"},\\\"properties(additionalData(GivenName))\\\":{\\\"value\\\":\\\"Melissa\\\"},\\\"properties(additionalData(IsDeleted))\\\":{\\\"value\\\":\\\"False\\\"},\\\"properties(additionalData(IsEnabled))\\\":{\\\"value\\\":\\\"True\\\"},\\\"properties(additionalData(JobTitle))\\\":{\\\"value\\\":\\\"Rig Engineer II\\\"},\\\"properties(additionalData(MailAddress))\\\":{\\\"value\\\":\\\"Melissa.Taylor@bpx.com\\\"},\\\"properties(additionalData(ManagerName))\\\":{\\\"value\\\":\\\"Zachary Evenhouse\\\"},\\\"properties(additionalData(OnPremisesDistinguishedName))\\\":{\\\"value\\\":\\\"CN=Melissa.Taylor,OU=Users,OU=PEC,DC=AD,DC=BPX,DC=COM\\\"},\\\"properties(additionalData(OnPremisesSamAccountName))\\\":{\\\"value\\\":\\\"Melissa.Taylor\\\"},\\\"properties(additionalData(Surname))\\\":{\\\"value\\\":\\\"Taylor\\\"},\\\"properties(additionalData(UserType))\\\":{\\\"value\\\":\\\"Member\\\"},\\\"properties(additionalData(UpnName))\\\":{\\\"value\\\":\\\"Melissa.Taylor@BPX.COM\\\"},\\\"properties(additionalData(SyncFromAad))\\\":{\\\"value\\\":\\\"True\\\"},\\\"properties(additionalData(PhoneNumber))\\\":{\\\"value\\\":\\\"+1 4325561409\\\"},\\\"properties(additionalData(CompanyName))\\\":{\\\"value\\\":\\\"Applied Consultants\\\"},\\\"properties(additionalData(StreetAddress))\\\":{\\\"value\\\":\\\"United StatesDenverBP - L481700 Platte StDenver Riverview80202\\\"},\\\"properties(additionalData(Country))\\\":{\\\"value\\\":\\\"United States of America\\\"},\\\"properties(friendlyName)\\\":{\\\"value\\\":\\\"Melissa Taylor (Applied Consultants)\\\"}},\\\"MailboxEntity\\\":{\\\"id\\\":{\\\"value\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Entities/9b95a81c-c169-8d15-3f04-7f7fa8461c1c\\\"},\\\"name\\\":{\\\"value\\\":\\\"9b95a81c-c169-8d15-3f04-7f7fa8461c1c\\\"},\\\"type\\\":{\\\"value\\\":\\\"Microsoft.SecurityInsights/Entities\\\"},\\\"kind\\\":{\\\"value\\\":\\\"Mailbox\\\"},\\\"properties(mailboxPrimaryAddress)\\\":{\\\"value\\\":\\\"melissa.taylor@bpx.com\\\"},\\\"properties(displayName)\\\":{\\\"value\\\":\\\"Melissa Taylor (Applied Consultants)\\\"},\\\"properties(upn)\\\":{\\\"value\\\":\\\"melissa.taylor@bpx.com\\\"},\\\"properties(additionalData(Source))\\\":{\\\"value\\\":\\\"OATP\\\"},\\\"properties(additionalData(Urn))\\\":{\\\"value\\\":\\\"urn:UserEntity:d1ae5b4d33e5e8388bcb9101fab509c4\\\"},\\\"properties(additionalData(FirstSeen))\\\":{\\\"value\\\":\\\"2025-05-07T21:58:51Z\\\"},\\\"properties(friendlyName)\\\":{\\\"value\\\":\\\"melissa.taylor@bpx.com\\\"}},\\\"MailMessageEntity\\\":{\\\"id\\\":{\\\"value\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Entities/b6d13050-986b-e96b-1851-cbf60dbd798a\\\"},\\\"name\\\":{\\\"value\\\":\\\"b6d13050-986b-e96b-1851-cbf60dbd798a\\\"},\\\"type\\\":{\\\"value\\\":\\\"Microsoft.SecurityInsights/Entities\\\"},\\\"kind\\\":{\\\"value\\\":\\\"MailMessage\\\"},\\\"properties(fileEntityIds)\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(recipient)\\\":{\\\"value\\\":\\\"Melissa.Taylor@bpx.com\\\"},\\\"properties(senderIP)\\\":{\\\"value\\\":\\\"209.85.210.54\\\"},\\\"properties(p2Sender)\\\":{\\\"value\\\":\\\"bobby.arnn@gmail.com\\\"},\\\"properties(receiveDate)\\\":{\\\"value\\\":\\\"2025-05-22 22:58:38 UTC\\\"},\\\"properties(networkMessageId)\\\":{\\\"value\\\":\\\"fcf39e48-6cc6-482f-d010-08dd998430a7\\\"},\\\"properties(internetMessageId)\\\":{\\\"value\\\":\\\"D584C797-070F-48CD-9880-96A80C7A0FC0@gmail.com\\\"},\\\"properties(subject)\\\":{\\\"value\\\":\\\"Apache North Reports B.Arnn 5-22-25\\\"},\\\"properties(antispamDirection)\\\":{\\\"value\\\":\\\"Unknown\\\"},\\\"properties(deliveryAction)\\\":{\\\"value\\\":\\\"Unknown\\\"},\\\"properties(friendlyName)\\\":{\\\"value\\\":\\\"fcf39e48-6cc6-482f-d010-08dd998430a7\\\"}},\\\"SecurityAlertEntity\\\":{\\\"id\\\":{\\\"value\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Entities/49b86450-9611-60de-7954-e0fc6ead3451\\\"},\\\"name\\\":{\\\"value\\\":\\\"49b86450-9611-60de-7954-e0fc6ead3451\\\"},\\\"type\\\":{\\\"value\\\":\\\"Microsoft.SecurityInsights/Entities\\\"},\\\"kind\\\":{\\\"value\\\":\\\"SecurityAlert\\\"},\\\"properties(systemAlertId)\\\":{\\\"value\\\":\\\"49b86450-9611-60de-7954-e0fc6ead3451\\\"},\\\"properties(tactics)\\\":{\\\"value\\\":\\\"InitialAccess\\\"},\\\"properties(alertDisplayName)\\\":{\\\"value\\\":\\\"Email reported by user as not junk\\\"},\\\"properties(description)\\\":{\\\"value\\\":\\\"This alert is triggered when any email message is reported as not junk by users -V1.0.0.0\\\"},\\\"properties(confidenceLevel)\\\":{\\\"value\\\":\\\"Unknown\\\"},\\\"properties(severity)\\\":{\\\"value\\\":\\\"Low\\\"},\\\"properties(vendorName)\\\":{\\\"value\\\":\\\"Microsoft\\\"},\\\"properties(productName)\\\":{\\\"value\\\":\\\"Office 365 Advanced Threat Protection\\\"},\\\"properties(alertType)\\\":{\\\"value\\\":\\\"79b0a077-8446-4d8c-b335-d89cdcd60b08\\\"},\\\"properties(processingEndTime)\\\":{\\\"value\\\":\\\"2025-05-23 02:17:29 UTC\\\"},\\\"properties(status)\\\":{\\\"value\\\":\\\"New\\\"},\\\"properties(endTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:17:00 UTC\\\"},\\\"properties(startTimeUtc)\\\":{\\\"value\\\":\\\"2025-05-23 02:16:00 UTC\\\"},\\\"properties(timeGenerated)\\\":{\\\"value\\\":\\\"2025-05-23 02:17:23 UTC\\\"},\\\"properties(providerAlertId)\\\":{\\\"value\\\":\\\"f41d1b16-ad89-5eda-4e10-08dd999fd574\\\"},\\\"properties(alertLink)\\\":{\\\"value\\\":\\\"https://security.microsoft.com/alerts/faf41d1b16-ad89-5eda-4e10-08dd999fd574?tid=79c3fa05-64e6-40a0-882c-2cb7fb4923c0\\\"},\\\"properties(resourceIdentifiers(type))\\\":{\\\"value\\\":\\\"LogAnalytics\\\"},\\\"properties(resourceIdentifiers(workspaceId))\\\":{\\\"value\\\":\\\"8b36b694-a442-4633-8900-adb0fe4d94b3\\\"},\\\"properties(additionalData(OriginalProductName))\\\":{\\\"value\\\":\\\"Office 365 Advanced Threat Protection\\\"},\\\"properties(additionalData(OriginalProductComponentName))\\\":{\\\"value\\\":\\\"\\\"},\\\"properties(additionalData(DetectionSource))\\\":{\\\"value\\\":\\\"microsoftDefenderForOffice365\\\"},\\\"properties(friendlyName)\\\":{\\\"value\\\":\\\"Email reported by user as not junk\\\"}},\\\"allSecurityAlerts\\\":[{\\\"id\\\":\\\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Entities/49b86450-9611-60de-7954-e0fc6ead3451\\\",\\\"name\\\":\\\"49b86450-9611-60de-7954-e0fc6ead3451\\\",\\\"type\\\":\\\"Microsoft.SecurityInsights/Entities\\\",\\\"kind\\\":\\\"SecurityAlert\\\",\\\"properties\\\":{\\\"systemAlertId\\\":\\\"49b86450-9611-60de-7954-e0fc6ead3451\\\",\\\"tactics\\\":[\\\"InitialAccess\\\"],\\\"alertDisplayName\\\":\\\"Email reported by user as not junk\\\",\\\"description\\\":\\\"This alert is triggered when any email message is reported as not junk by users -V1.0.0.0\\\",\\\"confidenceLevel\\\":\\\"Unknown\\\",\\\"severity\\\":\\\"Low\\\",\\\"vendorName\\\":\\\"Microsoft\\\",\\\"productName\\\":\\\"Office 365 Advanced Threat Protection\\\",\\\"alertType\\\":\\\"79b0a077-8446-4d8c-b335-d89cdcd60b08\\\",\\\"processingEndTime\\\":\\\"2025-05-23T02:17:29.28Z\\\",\\\"status\\\":\\\"New\\\",\\\"endTimeUtc\\\":\\\"2025-05-23T02:17:00Z\\\",\\\"startTimeUtc\\\":\\\"2025-05-23T02:16:00Z\\\",\\\"timeGenerated\\\":\\\"2025-05-23T02:17:23.9433333Z\\\",\\\"providerAlertId\\\":\\\"f41d1b16-ad89-5eda-4e10-08dd999fd574\\\",\\\"alertLink\\\":\\\"https://security.microsoft.com/alerts/faf41d1b16-ad89-5eda-4e10-08dd999fd574?tid=79c3fa05-64e6-40a0-882c-2cb7fb4923c0\\\",\\\"resourceIdentifiers\\\":[{\\\"type\\\":\\\"LogAnalytics\\\",\\\"workspaceId\\\":\\\"8b36b694-a442-4633-8900-adb0fe4d94b3\\\"}],\\\"additionalData\\\":{\\\"OriginalProductName\\\":\\\"Office 365 Advanced Threat Protection\\\",\\\"OriginalProductComponentName\\\":null,\\\"DetectionSource\\\":\\\"microsoftDefenderForOffice365\\\"},\\\"friendlyName\\\":\\\"Email reported by user as not junk\\\"}}]}\",\"incident_id\":\"984b9b9f-387b-4b4d-b50f-677259fd3f9b\",\"u_id\":\"/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Inc\",\"sentinel_incident_id\":\"97645\",\"sys_updated_by\":\"system\",\"u_properties_status_\":\"New\",\"u_properties_additionaldata_alertcount_\":\"1\",\"u_properties_a_rincidenturl__\":\"https://security.microsoft.com/incident2/87945/overview?tid=79c3fa05-64e6-40a0-882c-2cb7fb4923c0\",\"sys_created_on\":\"2025-05-23 06:15:59\",\"sys_domain\":\"global\",\"sys_import_set\":\"c100302b3be1a6544474ef0864e45a97\",\"u_properties_additionaldata_alertproductsname_\":\"Office 365 Advanced Threat Protection\",\"sys_created_by\":\"system\",\"sys_import_row\":\"140\",\"integration_run\":\"013a30bb3bad6a544474ef0864e45a93\",\"profile\":\"4f6c45583b256a904474ef0864e45a8e\",\"u_properties_lastmodifiedtimeutc_\":\"2025-05-23 02:21:48\",\"u_properties_additionaldata_tactics_\":\"InitialAccess\",\"u_properties_lastactivitytimeutc_\":\"2025-05-23 02:17:00\",\"u_properties_createdtimeutc_\":\"2025-05-23 02:17:24\",\"u_properties_severity_\":\"Low\",\"historic_run\":\"true\",\"u_properties_l_ls_labelname__\":\"Playbook: Suspicious email activity\",\"u_properties_title_\":\"Email reported by user as not junk\",\"sys_class_name\":\"sn_sec_sentinel_incident_import\",\"sys_id\":\"614ab0fb3bad6a544474ef0864e45abc\",\"u_type\":\"Microsoft.SecurityInsights/Incidents\",\"u_properties_incidentnumber_\":\"97645\",\"u_properties_firstactivitytimeutc_\":\"2025-05-23 02:16:00\",\"sys_mod_count\":\"0\",\"u_properties_incidenturl_\":\"https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/ddcf4558-c078-4122-a657-3a511dc10f2b/resourceGroups/DigitalSecurityRG_xds/providers/Microsoft.OperationalInsights/workspaces/DigitalSecurity-XDS/providers/Microsoft.SecurityInsights/Incidents/984b9b9f-387b-4b4d-b50f-677259fd3f9b\",\"u_properties_l_ls_labeltype__\":\"User\",\"sys_import_state\":\"pending\",\"u_properties_additionaldata_commentscount_\":\"0\",\"u_properties_providerincidentid_\":\"87945\"} {\"upon_reject\":\"cancel\",\"sys_updated_on\":\"2025-05-23 06:16:00\",\"enforce_restriction\":\"false\",\"number\":\"SIR0011331\",\"state\":\"10\",\"template_workflow_invoked\":\"false\",\"sys_created_by\":\"system\",\"knowledge\":\"false\",\"impact\":\"3\",\"active\":\"true\",\"priority\":\"4\",\"sla_suspended\":\"false\",\"risk_change\":\"up\",\"short_description\":\"Email reported by user as not junk\",\"sys_class_name\":\"sn_si_incident\",\"reassignment_count\":\"0\",\"hierarchical_variables\":\"variable_pool\",\"business_criticality\":\"2\",\"opened_for\":\"system\",\"has_appointment\":\"false\",\"escalation\":\"0\",\"upon_approval\":\"proceed\",\"correlation_id\":\"97645\",\"spam\":\"false\",\"made_sla\":\"true\",\"is_catalog\":\"false\",\"alert_rule\":\"Email reported by user as not junk\",\"task_effective_number\":\"SIR0011331\",\"sys_updated_by\":\"system\",\"opened_by\":\"system\",\"sys_created_on\":\"2025-05-23 06:16:00\",\"sys_domain\":\"global\",\"opened_at\":\"2025-05-23 06:16:00\",\"task_created\":\"false\",\"risk_score_override\":\"false\",\"assignment_group\":\"937fa491fba1a6d03867f7e4aeefdc24\",\"sys_id\":\"b14ab0fb3bad6a544474ef0864e45ae3\",\"contact_type\":\"siem\",\"urgency\":\"1\",\"severity\":\"2\",\"risk_score\":\"47\",\"approval\":\"not requested\",\"sys_mod_count\":\"0\",\"billable\":\"false\",\"risk\":\"3\",\"security_incident_self\":\"b14ab0fb3bad6a544474ef0864e45ae3\"} org.mozilla.javascript.NativeArray@18fda842 org.mozilla.javascript.NativeArray@76972b76 org.mozilla.javascript.NativeArray@1a3a619a false false Two main Queries is >> Why the transform script is not executing If by using Tranform script is there are multiple user impacted can we handle such scenario in sn_si_m2m_task_affected_user table >> Is it recommend to customize the OOB script include to which is working which customer has implemented",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1102781",
      "parent_case": "CS8305123",
      "subject": "MS Sentinel SIRs not being generated",
      "description": "------------------------------------ Please conduct testing on spirit instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes/No ------------------------------------ Assistance Requested: MS Sentinel SIRs not being generated Affected instance(s): spirit Affected version(s): Xanadu Patch 7a Plugin : Microsoft Azure Sentinel Incident Ingestion Integration For Security Operations Version: 11.0.21 Issue Definition: MS Sentinel SIRs not being generated Investigation Summary: 1. We see that the Raw data is getting stuck at \"ready to process\" https://spirit.service-now.com/sn_sec_sentinel_incident_raw_list.do?sysparm_view=&sysparm_query=state%3Dready_to_process&sysparm_fixed_query= 2. When we checked for the job \"Azure Sentinel Process Raw Data\" we see that it ran more than 4 hrs. So to provide relief we asked the customer to cancel the job, 3. The Azure Sentinel Process Raw Data job re-triggered and it is still running for more than 1 hr. [app130158.syd201:/glide/nodes/spirit017_16004/logs]$ cat localhost_log.2025-05-26.txt | grep 'a16fc1c99371' | head 2025-05-26 22:00:41 (623) worker.6 worker.6 txid=a16fc1c99371 LocalhostTransactionLogger *** Start Background transaction - system, type: other, user: system 2025-05-26 22:00:41 (626) worker.6 worker.6 txid=a16fc1c99371 JobExecutor Starting: Azure Sentinel Process Raw Data.de023ae6835e9a907a8c4fe16daad30b, Trigger Type: Repeat, Priority: 100, Upgrade Safe: true, Repeat: 1 MinuteName: Azure Sentinel Process Raw Data 2025-05-26 22:00:41 (769) worker.6 worker.6 txid=a16fc1c99371 SSI_43a8b3a843413110dcd896ed3ab8f2ea context=Transformer, fThrottlerSources=[ReadReplicaThrottlerSource(enabled=true, thresholdSecs=150, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null), StandbyThrottlerSource(enabled=false, thresholdSecs=1200, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null)] 2025-05-26 22:00:41 (772) worker.6 worker.6 txid=a16fc1c99371 SSI_43a8b3a843413110dcd896ed3ab8f2ea Using import set: ISET0011945, table sn_sec_sentinel_incident_import 2025-05-26 22:00:42 (078) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df [AMB] AMBQueue channel_id=/activity/events/6d6fc1c99371ead8e243f37e1dba1077 Published amb message, sys_id: bd6f85c99371ead8e243f37e1dba10fc, length: 748 2025-05-26 22:00:42 (089) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df [AMB] AMBQueue channel_id=/vis/count/29c2728e93656610fde6fc4badba1004 Published amb message, sys_id: f16f85c99371ead8e243f37e1dba10fe, length: 184 2025-05-26 22:00:42 (089) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df record-watcher Responder action summary - executionType: synchronous, changeType: ENTER, responder: PAVisRealtimeCountResponder, watchedRecord(s): 1, watchedTable: sn_si_incident, recordIdentifier: 6d6fc1c99371ead8e243f37e1dba1077, updatedTable: sn_si_incident, timeTaken: 7 ms 2025-05-26 22:00:42 (092) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df [AMB] AMBQueue channel_id=/vis/count/61062268837d6e107a8c4fe16daad351 Published amb message, sys_id: b96f85c99371ead8e243f37e1dba10fe, length: 184 2025-05-26 22:00:42 (092) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df record-watcher Responder action summary - executionType: synchronous, changeType: ENTER, responder: PAVisRealtimeCountResponder, watchedRecord(s): 1, watchedTable: sn_si_incident, recordIdentifier: 6d6fc1c99371ead8e243f37e1dba1077, updatedTable: sn_si_incident, timeTaken: 2 ms 2025-05-26 22:00:42 (096) worker.6 worker.6 txid=a16fc1c99371 SSI_545943c977d32010b7c5cc1c9f5a99df [AMB] AMBQueue channel_id=/vis/count/b280e15c937d6a18e243f37e1dba1033 Published amb message, sys_id: 716f85c99371ead8e243f37e1dba10ff, length: 184 4. We see that import set record also created for the same and it is stuck in loading state. https://spirit.service-now.com/sys_import_set.do?sys_id=f01fa43c83fdaa507a8c4fe16daad39a&sysparm_record_target=sys_import_set&sysparm_record_row=1&sysparm_record_rows=1&sysparm_record_list=numberSTARTSWITHISET0011945%5EORDERBYnumber 5. From the above logs we see that below business rule is getting triggered continously. 2025-05-26 23:02:48 (889) worker.6 worker.6 txid=a16fc1c99371 SS_9ea276bac3485210f6dfde2a05013181 Slow business rule 'Indicator Detection' on sn_ti_m2m_task_observable:<span class = \"session-log-bold-text\"> Created 27-05-2025 16:02:46</span>, time was: 0:00:02.494 6. As per the sys_id 9ea276bac3485210f6dfde2a05013181, the custom business rule \"AssociatedObservables MitreAttackTechniq\" is triggering the OOB business rules \"Indicator Detection\" 7. We suspect that the above business rule got triggered for the last azure sentinel incident \"SIR0069004\" and is still triggering the \"Indicator Detection\". 8. The above custom business rule is creating records in the table \"sn_ti_m2m_task_observable\" 9. At present we suspect that the business rule \"AssociatedObservables MitreAttackTechniq\" is causing the issue. Please review and let us know if we are miss anything. 10. Our SME joined the call with the customer and suggested to disable the business rule and asked me to raise a task to dev since it is a P1. 11. Customer disabled the custom business rule",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1097978",
      "parent_case": "",
      "subject": "Assistance needed in Regulated Market Instance",
      "description": "Share to Worknotes View less",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1102418",
      "parent_case": "CS8303854",
      "subject": "SIR0216932 and SIR0216948 is frequently updating the assignment groups automatically by system, as they are getting reassigned continuously and getting multiple mails.",
      "description": "********TCASE TASK SUMMARY******** ------------------------------------ Please conduct testing on these instances only. - vanguardinfosys The customer has authorized access/changes to other instance(s.) - NO SNC Access Control? NO ------------------------------------ Assistance Requested: SIR0216932 and SIR0216948 is frequently updating the assignment groups automatically by system, as they are getting reassigned continuously and getting multiple mails. ------------------------------------ Affected instance(s): emaprod, emaacceptance ------------------------------------ Affected version(s): Washington DC Patch 10 Hot Fix 2a ------------------------------------ ----------------------------------------------- Issue Definition: ----------------------------------------------- SIR0216932 and SIR0216948 is frequently updating the assignment groups automatically by system, as they are getting reassigned continuously and getting multiple mails. ----------------------------------------------- Steps to Reproduce: ----------------------------------------------- Open the below SIRs and check the activities section , you will see the assignment group changing constantly within seconds and emails getting triggered Open SIR0216932 https://vanguardinfosys.service-now.com/sn_si_incident.do?sys_id=d7c7716097fdae50477eb27de053afad OR SR0216948 https://vanguardinfosys.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=9249c1b497f5ae90bab3fd70f053af1c ----------------------------------------------- Investigation Summary: ----------------------------------------------- Alert-0263490 was in the Open state. https://vanguardinfosys.service-now.com/nav_to.do?uri=em_alert.do?sys_id=af77fdac97bdae50477eb27de053af8a SIR0216932 got triggered. From the moment the SIR0216932 was in open state, the assigned group started fluctuating and sending a lot of emails https://vanguardinfosys.service-now.com/sn_si_incident.do?sys_id=d7c7716097fdae50477eb27de053afad Then the Customer closed the alert Alert-0263490 Then the customer closed the Alert-0263490 and reopened it. A new SIR0216948 got created. https://vanguardinfosys.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=9249c1b497f5ae90bab3fd70f053af1c ****However, the original issue is SIR0216932, is getting reassigned between 4 groups 1. DevOps-Support 2. SECURITY-IAM-OPERATIONS-SUPPORT 3. ServiceNow Support Team 4. infra cloud op --> Assignment Rules - https://vanguardinfosys.service-now.com/sysrule_assignment_list.do?sysparm_query=table%3Dsn_si_incident&sysparm_first_row=1&sysparm_view= --> Expected assignment Rule to be run - Prisma_Assignment_5_Policies | Assignment Rule https://vanguardinfosys.service-now.com/sysrule_assignment.do?sys_id=1b20a18edb3e3914e2698f381396190d&sysparm_record_target=sysrule_assignment&sysparm_record_row=1&sysparm_record_rows=6&sysparm_record_list=table%3Dsn_si_incident%5EORDERBYorder CMDB CI - Security Account https://vanguardinfosys.service-now.com/nav_to.do?uri=cmdb_ci.do?sys_id=0f4432b41b9e601086738448624bcb0b Correct Support Group - SECURITY-IAM-OPERATIONS-SUPPORT —> Node Logs attached —> DB Logs attached --> Actions tried for TEMP Relief - Tried updating the assignment rule by excluding the 2 SIRs in the conditions - DID NOT WORK Tried updating the Email notification condition by excluding the 2 SIRs in the Condition or Script - DID NOT Work ----------------------------------------------- Next Steps ----------------------------------------------- Need to reach out to DEV - Shravan Kumar Kusuma is already engaged in the investigation ----------------------------------------------- Knowledge Articles Researched: ----------------------------------------------- ----------------------------------------------- Documentation - -----------------------------------------------",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1101269",
      "parent_case": "CS8038671",
      "subject": "\"Add Email Search to Security Incident V1\" activity in CDW Manual Trigger - Transform Phishing Email to Security Incident V1 is getting canceled due to maximum time exceeded.",
      "description": "------------------------------------ Please conduct testing on unftest, unfqa, unf instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Flow is executing for more than 7 days and erroring out with \"maximum execution time exceeded\" at custom action Affected instance(s): unftest, unfqa, unf Affected version(s): Yokohama Patch 2 Issue Definition: Reference the attachment for relevant screenshots, logs of the error and documentation of the custom workflow and UI action configuration. We are experiencing issues with a custom workflow designed to convert phishing emails to security incidents manually using a repurposed out-of-the-box automated workflow via UI action on the Phishing Email record. The expected result is that analysts can manually create security incidents from phishing emails using this UI Action and flow. However, the current result is that the copied out-of-the-box workflow is erroring out at the action step for email search. Steps to Reproduce: -- Use Side_door.do for accessing the instance. 1. Use the flow: Ignore-CDW Manual Trigger - Transform Phishing Email to Security Incident V1\"2 2. Trigger the workflow via UI action on a phishing email record 3. Observe the error at the Email Search activity step in Test. Investigation Summary: -- Flow: \"Ignore-CDW Manual Trigger - Transform Phishing Email to Security Incident V1\"\" https://unftest.service-now.com/now/workflow-studio/builder?builderId=flow&sysId=006b21c5472e1a50c2822f0fe16d434f&tableName=sys_hub_flow -- Latest Example flow: https://unftest.service-now.com/nav_to.do?uri=sys_flow_context.do?sys_id=d47000092dacae5093ec3df10768b448 --Flow action causing the issue: \"Add Email Search to Security Incident V1\" https://unftest.service-now.com/now/workflow-studio/builder?builderId=action&sysId=187161c3b3d33300ed7fc9c316a8dc13&tableName=sys_hub_action_type_definition -- Script include called in the flow action: \"EmailSearchCapabilityUtil\" https://unftest.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=4a98dc1c0b133200263a089b37673ad5 -- Found an issue with access & tracking between scope apps. The last entry from the node logs: 2025-03-25 13:02:52 (396) worker.0 worker.0 txid=61b1804587a8 Log WARNING *** WARNING *** Security restricted: Unable to identify source of the Read operation on table 'sn_si_m2m_task_affected_user' from scope 'Security Operations Spoke'. No Restricted Caller Access privilege records were created. The operation was allowed because target resource RCA policy is set to 'Tracking', but will be blocked with the 'Restricted' policy. Please contact the application admin. With the customer's permission, work on: 1) Terminating all long-running Flow Engine Event Handlers from the \"Active Transactions (All Nodes)\" Module 2) Set the RCA record and allow access between the scopes mentioned in the node log entry above: System Application -> Restricted Caller Access Privileges 3) test again -- Customer has tested the issue in \"unfqa\" where the same error's are displayed but the flow is executed as expected. Below are the successful flow execution: https://unfqa.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3Dd41af9b81915ee5064af4a75fff3e168 https://unfqa.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3Df1b9bd787f15ee50fbe3457b94972deb I have also attached the node logs for the flow execution which show the same RCA error but the flow execution is successful. -- Reached out to the Flow dev team via CSTASK1059783 and they provided below update. I have verified the following execution on \"unf\" instance: https://unf.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_flow_context%26sysId%3D9dbc71b479192ed0d12be6da76511aba The Script step of Action 11: \"Add Email Search to Security Incident V1\" is taking more than 5 minutes so system is cancelling the Transaction and Flow also getting cancelled with the same reason. In the above action its using Script Include \"EmailSearchCapabilityUtil\" https://unf.service-now.com/sys_script_include.do?sys_id=4a98dc1c0b133200263a089b37673ad5 which is taking more than 5 minutes of time to complete. Please do work with Script owners to understand the issue. I see there is a while loop in the script(createEmailSearchFromList function) and possible cause of the issue, it might be infinitely iterating the while loop due to provided input but script owners can confirm the same. -- Need help in understanding why the \"Add Email Search to Security Incident V1\" action is taking a long time to execute.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1101484",
      "parent_case": "CS8183009",
      "subject": "Customer would like to request to update the regex to be more inclusive to catch more scenarios as part of 'Handle Deprecated Observable Fields' BR",
      "description": "------------------------------------​ Please conduct testing on 'mcsmdev' instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No ------------------------------------​ Assistance Requested: ​The regex that ServiceNow is using to populate the Observables into the table does not recognize the following senarios, we're requesting if this can be update to be more inclusive of these particular senarios that are currently being missed and consider if this is a bug or not. Affected instance(s): mcsmdev​ Affected version(s): Yokohama Patch 3​ Issue Definition: Customer would like to request to update the regex to be more inclusive to catch more scenarios. They noticed a few URL's and Filepaths that are not matching as they should, here are the examples and a reason why they are not matching. Filepath: C:\\progs\\nmap\\$_repo_oldv\\nmap-7.95-setup\\nmap.exe (Contains a '$') C:\\Users\\<USER>\\AppData\\Local\\Temp\\3582-490\\nmap.exe (Contains a '<') URL: https://mywfx.backstory.chronicle.security/alert?alertId=de_e3e7e291-79bc-f5b5-7b85-a26bac347ec6 (has multiple subdomains) Do we need to modify the regex to be more inclusive to these conditions? Current Regex: RegexValidationUtil.DOMAIN = /^(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?\\.)+[a-zA-Z0-9][a-zA-Z0-9-]{0,253}[a-zA-Z0-9]$/; RegexValidationUtil.FILEPATH = /^([a-zA-Z0-9\\s_\\\\.\\-\\(\\):\\/])+\\.[a-zA-Z0-9_-]+$/; Proposed URL regex: Domain: /^(https?:\\/\\/)?(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,253}[a-zA-Z0-9])?\\.)+[a-zA-Z0-9][a-zA-Z0-9-]{0,253}[a-zA-Z0-9]$/ FilePath: /^([a-zA-Z0-9\\s_\\\\.\\-\\(\\):\\/$])+\\.[a-zA-Z0-9_-]+$/ Steps to Reproduce: Not available Investigation Summary: ​ - Plugins on subprod installed: sn_si : 13.6.6v (up to date) sn_ti_ac: 13.3.0v (13.3.1 version available) - On the Security Incident Response module in ServiceNow, there is a Business rule Handle Deprecated Observable Fields handles the field updates of the IOC Scratchpad Fields (source_ip, malware_url, etc) then refers to the ThreatUtils Script Include to determine what type and category of observable is being populated. ThreatUtils on line 1222 then refers to the RegexValidationUtil script include to determine/validate what type of observable the observable object is, The regex used starts on line 140 of the RegexValidationUtil script. The regex that ServiceNow is using to populate the Observables into the table does not recognize the following senarios, we're requesting if this can be update to be more inclusive of these particular senarios that are currently being missed. Filepath: C:\\progs\\nmap\\$_repo_oldv\\nmap-7.95-setup\\nmap.exe (Contains a '$') C:\\Users\\<USER>\\AppData\\Local\\Temp\\3582-490\\nmap.exe (Contains a '<') Notes: If a filepath contains $ or < ServiceNow doesn't recognize this as a filepath, and instead assigns it to the 'Unknown' category of observables. URL: https://mywfx.backstory.chronicle.security/alert?alertId=de_e3e7e291-79bc-f5b5-7b85-a26bac347ec6 (has multiple subdomains) Notes: ServiceNow is missing this URL because it contains more than 1 Subdomain level. Links to the mentioned scripts: Business Rule: Handle Deprecated Observable Fields - https://mcsmdev.service-now.com/nav_to.do?uri=sys_script.do?sys_id=e1d8f5d20b3032009f66e94685673a18 Script Includes: ThreatUtils - https://mcsmdev.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=ed817d045332020034c69816a11c0819 RegexValidationUtil - https://mcsmdev.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=13d84283d73312007a6de294de610363 All are OOB versions. The regex that ServiceNow is using to populate the Observables into the table does not recognize the following senarios, we're requesting if this can be update to be more inclusive of these particular senarios that are currently being missed.\" That's this https://codesearch.devsnc.com/source/xref/npm/app-secops/app-sir/src/main/plugins/com.snc.security_incident/update/sys_script_e1d8f5d20b3032009f66e94685673a18.xml?r=fc7e9c65 = Security Incident Response Is this a bug that we need to consider to enhance our product. ​",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1100672",
      "parent_case": "CS8268167",
      "subject": "​OOB BR \"Rollup MITRE Technique From Lookup\" & \"Calculate MITRE Search Tag\" that query OOB SI \"MITREUtil\" observed to be causing performance issues on the instance.",
      "description": "------------------------------------​ Please conduct testing on 'doitmarylandtest' instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No ------------------------------------​ Assistance Requested: ​OOB BR \"Rollup MITRE Technique From Lookup\" & \"Calculate MITRE Search Tag\" that query OOB SI \"MITREUtil\" observed to be causing performance issues on the instance. Affected instance(s): doitmarylandtest (subprod) Affected version(s): (Yokohama Patch 1a)​​ Issue Definition: 1. When adding observables in the \"Add Multiple Observables\" section at the bottom of a SIR ticket, the observable import will stall out and display \"Running transaction\" with a timer (See attachment). This will go on forever until canceled. Once canceled, SNOW takes around 5 minutes to unfreeze and is finally usable again. This is happening on almost every single ticket now, no matter the import size, and is causing an impact on the time it takes to resolve a ticket. Other SOC analysts are also experiencing this issue. 2. Also, is there a way for the observables import can exclude comma delimiters while importing? This is a question that came from a customer where they have a few statements with comma separation, which sometimes create new line items with comma separation breakdown Steps to Reproduce: When adding observables in the \"Add Multiple Observables\" section at the bottom of a SIR ticket, the observable import will stall out and display \"Running transaction\" with a timer (See attachment). Tried to load the following observables in TEST, and the page froze for about 2-4 minutes. Screenshot attached. Timeline - Around - 11:13 AM Eastern Record : SIR0055588 Observable List angeleslupita185@gmail.com Order confirmed for your upcoming Friday visit via Madeline Love +1 (678)-273-4506 93938JIH61726_ERK184583141LK603WFTU.docx 4bc998054f7252e185dc9d0d2421162c dcade49a0b4758b56a1acdf57fcb21cd47dcedf2053cc7222a4aa74d24cf354d gmail.com maryland.gov 209.85.220.69 209.85.220.41 david.stine@maryland.gov prahalad.pateel@maryland.gov dluiitadmin-dllr@maryland.gov Investigation Summary: ​ - Ex. SIR0055588 : https://doitmarylandtest.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=c9603d2a93e56250cf2ab92b1bba1027 - Found the Transaction log: https://doitmarylandtest.service-now.com/syslog_transaction.do?sys_id=4202e41393e52e9066bdf9c47aba10bf - Node Logs: https://splunk.servicenow.net/en-US/app/search/search?earliest=1747810800&latest=1747897200&q=search%20instance%20%3D%20doitmarylandtest%20%7C%20search%20%224202e41393e5%22%20%7C%20sort%20_time&display.page.search.mode=verbose&dispatch.sample_ratio=1&sid=1747947780.220111_2E64B6A5-3172-4185-9C7D-0DCE1FF179CF - Some of the logs I will be posting below: ------------------------------------------ 2025-05-21 08:18:06 (295) Default-thread-15 8CD16C5393E52E9066BDF9C47ABA1008 txid=4202e41393e5 tx_pattern_hash=-1817640731 LocalhostTransactionLogger EXCESSIVE *** End #705500 /ui_page_process.do referer: /sn_si_incident.do, user: Srikanth.Depally@maryland.gov, r_status: 200, render_size: 0, total time: 0:04:58.773, processing time: 0:04:58.773, CPU time: 0:03:37.823, SQL time: 0:01:32.809 (count: 314,709), business rule: 0:00:00.366 (count: 1,777), Cache build time: 0:00:00.014, Script time: 0:09:50.978 (count: 6,898), Total memory allocated: 68.92GB, source: 173.69.176.175, type: form, Speed: 0, ISS: false, origin scope: sn_si, app scope: sn_si 2025-05-21 08:18:06 (135) Default-thread-15 8CD16C5393E52E9066BDF9C47ABA1008 txid=4202e41393e5 SSI_4a30b88dd7c322007a6de294de610356 Slow business rule 'Rollup MITRE Technique From Lookup' on sn_ti_m2m_task_observable:<span class = \"session-log-bold-text\"> Created 05-21-2025 11:13:07</span>, time was: 0:04:58.110 2025-05-21 08:18:06 (134) Default-thread-15 8CD16C5393E52E9066BDF9C47ABA1008 txid=4202e41393e5 SSI_09398b1ee76c10106b3663c343f6a965 Slow business rule 'Calculate MITRE Search Tag' on sn_ti_stix2_m2m_incident_attack:<span class = \"session-log-bold-text\"> Created 05-21-2025 11:18:03</span>, time was: 0:00:03.043 2025-05-21 08:13:12 (665) Default-thread-15 8CD16C5393E52E9066BDF9C47ABA1008 txid=4202e41393e5 SSI_09398b1ee76c10106b3663c343f6a965 [0:00:00.001] Expanding large row block (file.read: sn_ti_stix2_m2m_lookup_attack, 10000 rows, 160000 dataSize) 2025-05-21 08:13:12 (663) Default-thread-15 8CD16C5393E52E9066BDF9C47ABA1008 txid=4202e41393e5 SSI_09398b1ee76c10106b3663c343f6a965 WARNING *** WARNING *** Large Table: Table handling an extremely large result set: 29024 Query that got us here is: TABLENAME = sn_ti_stix2_m2m_lookup_attack ENCODED_QUERY = lookupIN0162896e93a946d0dca43c327cba1036,0186b1b947489a9893adb2c3716d43cc,0252f9e84730da5493adb2c3716d4307,029374341b5b65900857eb53604bcb1a,039d4c2a87837d10d6c70faf8bbb35bb,03f183e247e3d2d4305ca2e4116d434b,04336d9293858210dca43c327cba105e,044bded8fb74a6548e12f94265efdc37,04954f2f1b5729100857eb53604bcbb8,0555f6d747ab0a149fbbc9a4116d43db,065fba773390ea90028be7c13d5c7bfa,07794f3c4754d6509fbbc9a4116d435c,07dd444d474d925893adb2c3716d4337,09bd64c147311210305ca2e4116d435f,09cf644993ee0e90dca43c327cba10cf,0a80818e47b8de1093adb2c3716d4314,0bb0fd57474b02149fbbc9a4116d43de,0c3b09f393609ed8f180f6ad1dba10fd,0c871c0547ab029893adb2c3716d43ba,0cee686d93b8a21066bdf9c47aba10d7,0d135d9c931a9a5460c6b1da6aba10ca,0d515b4647ea06d0305ca2e4116d433a,0fa45068934b5e54f418b01e1dba10a4,104c0b1493e64250dca43c327cba103e,106da2fa47a4de989fbbc9a4116d4397,111079f297e735d466c0b45e6253afc5,1138df6d3b6c2ad06ef7363eb3e45a6b,12477b62937e8a10f180f6ad1dba10f7,12ec612e93001e10f180f6ad1dba10ef,1303b16793449e90f180f6ad1dba10cf,13c419aa47dac21c305ca2e4116d4366,155be4324785fd10b8105052e36d432a,1636691b93a49a98f180f6ad1dba1046,196b8aec93595e94f180f6ad1dba1081,1a27d31e4745f910b8105052e36d4337,1b3615b5471f465493adb2c3716d436d,1bd809c3934f1694dca43c327cba1028,1bde338b875d31543c4699f73cbb3518,1c8076961bc3a1100857eb53604bcb9f,1c8bd2bd478202d4305ca2e4116d43df,1d569a6f93ceca5cdca43c327cba1094,1d650dad4790de909fbbc9a4116d43cb,1f2b49f393609ed8f180f6ad1dba103e,2080894e47b8de1093adb2c3716d43c5,20b2c02597d8021866c0b45e6253af92,20c34cc293aa56d0dca43c327cba1079,2184d84b47920210305ca2e4116d4317,2192553947a0ce5093adb2c3716d4344,21b9904f93ee869060c6b1da6aba1084,21c67b8c1b32f1d40857eb53604bcbfb,21de616a47d91edc93adb2c3716d4339,22028a4b93db9a58f418b01e1dba10a6,22c8ba4f47b89ad093adb2c3716d433e,22de897093b21210dca43c327cba10f2,23863a5097173190b3e97c7e6253afcf,24541c9b47eb9618305ca2e4116d43c1,25159e5893da0adcdca43c327cba1036,252cf66847b7861493adb2c3716d43b1,259ef6aa93838a90f180f6ad1dba104c,25b9904f93ee869060c6b1da6aba10ad,26460bf71bcf2d500857eb53604bcb96,266320931b2bfd940857eb53604bcba9,269582a247264a90f3050201516d43b3,269ee320478bc21093adb2c3716d437e,26cb79224701dad09fbbc9a4116d4376,28446a9d87b77990d6c70faf8bbb3533,297ab0b91beab1540857eb53604bcb9e,2a21636f4778525493adb2c3716d43f9,2a28b3c397d33d9066c0b45e6253af25,2a5a68cd93831250dca43c327cba10cd,2a9aafc093534214244fbeedfaba1026,2b3470c58798b9943c4699f73cbb35f9,2b5ffa773390ea90028be7c13d5c7be4,2b6b53921ba765900857eb53604bcb8e,2c9d37c84749d2d493adb2c3716d4349,2d6e96b987b63dd0d6c70faf8bbb35d2,2e61cf794791da5c93adb2c3716d432c,2f0fbd5a3b1cee506ef7363eb3e45a24,314c209bfbecea908e12f94265efdcda,31c0298447460a98f3050201516d436a,32095bf747748e50dfcbaa6b416d43a6,347533fa4780e250f3050201516d4398,34fd72d447a8f150b8105052e36d4370,358eb59d932e1a50dca43c327cba1056,35e4f57193979a54f418b01e1dba10c2,3669f1e44763ce1893adb2c3716d4359,36a4afcd47adf910b8105052e36d4334,36dec59f87cfbd50d6c70faf8bbb3576,373354bc971b7990b3e97c7e6253afa2,37393e4f475d06900faf1aba516d43bc,379e2720478bc21093adb2c3716d4320,37d06f5097a3315466c0b45e6253af4f,386ff94b93985a50244fbeedfaba106f,38c931294730fd10b8105052e36d437a,3a46fccc93555e14f180f6ad1dba108f,3a566b1847360a94305ca2e4116d4375,3a5b987f93ce9a1460c6b1da6aba10d2,3af77e8a87a575503c4699f73cbb3597,3b8ab78097c44a50b3e97c7e6253af54,3c22dd6647781e9093adb2c3716d432f,3cf5e49d475ec698305ca2e4116d43ea,3d9f845a47954e100faf1aba516d4325,3ebc506097ff615034e53a200153af12,3ed31cf04744d21893adb2c3716d43f2,3ee961cd93730690244fbeedfaba1029,40875c0547ab029893adb2c3716d4307,40a306794774829493adb2c3716d438b,4111a11193450e10837e36a74dba10ce,418e759d932e1a50dca43c327cba10eb,42ab3d7d47f32590b8105052e36d432d,43f662f8472fd614305ca2e4116d433f,440b803b93a10e1460c6b1da6aba1058,449d583847241e949fbbc9a4116d437e,44ee3ebf93de1a90f418b01e1dba10a4,4515c7af47d8c61093adb2c3716d43b6,452a221597c80a90b3e97c7e6253af3a,4638290a9336dad0dca43c327cba1041,48cbe9ca47baca1093adb2c3716d4393,4a117d408731f990501c4377cebb3573,4a52ded91bcfad900857eb53604bcb7d,4abbda89473052d493adb2c3716d43fc,4b0341e79797b5d066c0b45e6253afb8,4be4f3d3475e8210f3050201516d43bd,4ccafd9647d29294f3050201516d436d,4ead30ca3360a290028be7c13d5c7bb1,4ed4c63993550a10b53e7ee48aba1042,50e646df93161e10f418b01e1dba10f6,52411189479a9a90f3050201516d43b5,529dd9e2475412549fbbc9a4116d4310,553bc9bb47630e5093adb2c3716d43be,556d4703479cb510b8105052e36d43b2,56b9605a87c4f914501c4377cebb35d3,56d074ad8793f950d6c70faf8bbb35cd,57efac4493238698244fbeedfaba1025,5846a66593cb1290dca43c327cba10c7,593ba66293ae5254dca43c327cba10cd,5998c31a47ab0a909fbbc9a4116d4384,5a5279e84730da5493adb2c3716d43ec,5a817d1c93498e50b53e7ee48aba1052,5c0436a893d75290f418b01e1dba10b3,5c8b16bd478202d4305ca2e4116d4338,5cc82f0d93695e50f180f6ad1dba106c,5cd6305297ef7dd4b3e97c7e6253afa4,5ced47e493f00ed0244fbeedfaba1006,5d1e435047d46e14f3050201516d43fe,5e8e1dad47dcf1d4b8105052e36d430b,5ec0b26f9339425860c6b1da6aba10c8,5f81dac51bd7a9900857eb53604bcb4d,5fef01c447624a50305ca2e4116d432b,6021a715472302109fbbc9a4116d43f1,60e6c6df93161e10f418b01e1dba1006,6180d3c9474db550b8105052e36d43e2,61b4b01c9786b15034e53a200153afc4,61d6f5613bd062106ef7363eb3e45a95,61fd8e6b9794315034e53a200153af21,628857fc1b123d100857eb53604bcb90,62c45bbe93ffda94dca43c327cba1007,6378766593006e58dca43c327cba10e4,6420ab2d473d0a94f3050201516d43be,644be76f93734618244fbeedfaba1000,64d73c661bb67d180857eb53604bcb55,650ae091931f9ad0f418b01e1dba103f,6558a95b93361690f418b01e1dba10de,65fc67571b43e5500857eb53604bcba7,665e6f2947929ed0f3050201516d4355,6797f57b93cb9a18dca43c327cba10b9,67f044af8785bd503c4699f73cbb35da,68bcde149758829466c0b45e6253af98,69980568931f0254244fbeedfaba1007,69bfbf0847cdb910b8105052e36d4345,69ce2d8697c80e9066c0b45e6253af06,6b48f38a1b227d540857eb53604bcb8e,6ba985d6934ca2d8dca43c327cba1092,6c626729972f6d1066c0b45e6253af46,6d2c11d54788a294f3050201516d43b1,6d9d30f03baca6506ef7363eb3e45a17,6e4a6f9c1beb61500857eb53604bcb22,6e4da2bf93f2da14f418b01e1dba100f,6f46300093955e14f180f6ad1dba105a,6fcb59259322c614dca43c327cba10f5,7028945247538e9493adb2c3716d4392,702ad83f47607dd0b8105052e36d4377,71426c791b7f75580857eb53604bcb3d,715cb29193bf5290dca43c327cba1023,7171e84397eeb994b3e97c7e6253afc5,7506352f1b52bd900857eb53604bcb57,7519233a477cb190b8105052e36d4350,7531f44f93dad2d0dca43c327cba10af,7608efdc937d8e14dca43c327cba1046,76604464870c79d03c4699f73cbb35d2,76f0d90e93b70a14244fbeedfaba1038,77a9149947d826d0305ca2e4116d43d8,7a3dc98f47b15294305ca2e4116d43ba,7b06e88897e8b55034e53a200153afe1,7b1b5731979b7dd0b3e97c7e6253af17,7b570552478ec618305ca2e4116d43df,7b8e954587577150d6c70faf8bbb35f3,7b9a88df937302d4244fbeedfaba1051,7cbf47bb93105ad0244fbeedfaba10c4,7cfbdff497623914b3e97c7e6253af6c,7d1ff48e471416149fbbc9a4116d437f,7e314dab47550e10f3050201516d43a5,7eab8c2193740654f180f6ad1dba10f3,7f3dc5cf47b15294305ca2e4116d436b,80f109199712715066c0b45e6253afac,81c861da97dff514b3e97c7e6253af29,82159e5893da0adcdca43c327cba1085,82f41288473a8654305ca2e4116d4382,845b199b4736029093adb2c3716d4376,848e3b7c87fba1503c4699f73cbb35c5,84ad8bed9751391034e53a200153af17,85cf644993ee0e90dca43c327cba109a,8697c286970e351034e53a200153af51,880b803b93a10e1460c6b1da6aba1072,883da4ef93a0ce90f180f6ad1dba105c,884b9ed8fb74a6548e12f94265efdc2a,88f6a009872fb910d6c70faf8bbb3530,8928945247538e9493adb2c3716d4381,896bcd8747a482909fbbc9a4116d43c1,8a52c7f297ff7d1066c0b45e6253af69,8a80244293271254dca43c327cba10e7,8bc0b26f9339425860c6b1da6aba10fd,8d3c1fb59301ce10b53e7ee48aba103d,8d610f794791da5c93adb2c3716d4369,8f43999b47059a149fbbc9a4116d438c,9054e5a747846690f3050201516d4350,9127e4499328ce10244fbeedfaba1098,921930ed93b20a1460c6b1da6aba1073,92c2aa239783f910b3e97c7e6253af6b,932dd8e1872c3150501c4377cebb351b,936b8aec93595e94f180f6ad1dba1005,93f01ef847843514b8105052e36d439f,93fb86bb47b4b510b8105052e36d438c,9475c1ed4790de909fbbc9a4116d4338,947a4ac287797114501c4377cebb35ca,94a2b77b1b9635d00857eb53604bcbf7,954e008093254a1060c6b1da6aba10a0,9584e8049737e91034e53a200153af5b,95cf4e834744f954b8105052e36d4398,9640ca2793d7ca58244fbeedfaba10ca,9736d1b5471f465493adb2c3716d43a4,9974e897873be9903c4699f73cbb3562,9a4c609bfbecea908e12f94265efdc2a,9ac2c54a47787550b8105052e36d431f,9ce52def873d3d143c4699f73cbb35a6,9d57029f47acb5d0b8105052e36d438d,9f0666b51bdb25d00857eb53604bcbad,9f74d84b47920210305ca2e4116d436e,9f9443df873bf510d6c70faf8bbb3584,a00f30ac47020ad8f3050201516d43c9,a00f70ac47020ad8f3050201516d4322,a0facafc1bcb69900857eb53604bcb72,a1334da4474a92d0f3050201516d4364,a1995fc9477cb910b8105052e36d4360,a1c67fda93539ad4f418b01e1dba1039,a3a2f7c69373d614dca43c327cba104c,a3a2f7c69373d614dca43c327cba1058,a3ae5edb97a6b19466c0b45e6253af3a,a4cbe9ca47baca1093adb2c3716d43fd,a5d6f5613bd062106ef7363eb3e45ac7,a6d2aa0c47f95a5093adb2c3716d43b5,a6de857093b21210dca43c327cba10b3,a750eae6931f82d4244fbeedfaba1072,a7bd86ec93640a10f180f6ad1dba10de,a83de935470742909fbbc9a4116d439f,aa862e8e974fbd14b3e97c7e6253afdd,aaedb16f8759b5543c4699f73cbb355d,ac8edc3b931b12d8f418b01e1dba10d6,adbce4d587c0f1143c4699f73cbb35ee,add4d9aa47dac21c305ca2e4116d43b2,adec33e9473d79d0b8105052e36d4362,ae0fc46197feb5d466c0b45e6253af82,b04baf8397484a1466c0b45e6253af63,b31d90fe47550650f3050201516d4317,b321636f4778525493adb2c3716d43e3,b33363368786f1503c4699f73cbb3592,b62801e19333c6d0244fbeedfaba10cc,b65f851c472796d0305ca2e4116d439c,b6e921cd93730690244fbeedfaba10ff,b6f2dc0747cf86d09fbbc9a4116d43e0,b75aee74977579d034e53a200153af51,b769b6a947cd929893adb2c3716d43b1,b838a9c69336dad0dca43c327cba10bf,b8cf93d9933e5e50dca43c327cba10f0,ba61978147b10294f3050201516d43b8,bc3bd47893bb1210dca43c327cba10a1,bd44c2b597d4ca1866c0b45e6253af52,bd63ae379360c6d0f180f6ad1dba10f7,bea1e9149719359034e53a200153af42,bebf5c1947c4525893adb2c3716d4389,bf1fd64747813550b8105052e36d431f,c021a715472302109fbbc9a4116d433c,c0ce5bdc93229ad0f418b01e1dba10aa,c13ba66293ae5254dca43c327cba1086,c1425e7297080214b3e97c7e6253af8a,c160aae6931f82d4244fbeedfaba10d1,c1ddf38c9388de18244fbeedfaba1052,c24721d547a01ad49fbbc9a4116d438b,c2ad70ca3360a290028be7c13d5c7b91,c2b7cb6c47450a90036fa5cc416d4358,c2eb2e66971e759066c0b45e6253afb1,c2f4de48473a8654305ca2e4116d4354,c3eca12e93001e10f180f6ad1dba10c5,c487ce554793421493adb2c3716d4325,c552e32593da8650dca43c327cba1031,c62e1f3897d482d466c0b45e6253afbb,c7ba801c97cf3950b3e97c7e6253af9b,c7d3c880474ce690f3050201516d4310,c8b24d191beaf5140857eb53604bcb7a,c8c38cc293aa56d0dca43c327cba1038,c8f0787297973554b3e97c7e6253afad,c9963dac47958690f3050201516d438c,c9cfd3d9933e5e50dca43c327cba1006,ca830fe787e575903c4699f73cbb3575,cb44aade47e80a9093adb2c3716d43fb,cbcf9312879c8610d6c70faf8bbb35aa,cc6d0b9c93e89a14244fbeedfaba10fc,cc87ec3e93721650f418b01e1dba10e2,ce131ef047edf510b8105052e36d432b,ce98431a47ab0a909fbbc9a4116d43f8,ced7cd8e93e5d2d0f180f6ad1dba10c1,cf771fe48711fd903c4699f73cbb35f9,d07e97f247238ed09fbbc9a4116d430b,d08542af93d81a90244fbeedfaba10a2,d0a755a693f30654244fbeedfaba105e,d11ae65247edda109fbbc9a4116d4394,d129d20147ce5e14f3050201516d4376,d15c479e930b9a14dca43c327cba103b,d25db1f797babd10b3e97c7e6253afcf,d2ec7876930a569060c6b1da6aba104c,d421874b1b96b5900857eb53604bcba1,d46f4a32930acad8dca43c327cba10ec,d528cda19333c6d0244fbeedfaba10f8,d579601687b3ed503c4699f73cbb35a2,d6a8438a47e07990b8105052e36d438a,d77353e3470c7194b8105052e36d431a,d81ea14493cf82d0f180f6ad1dba10b6,d9e4753193979a54f418b01e1dba10c6,da27162c9704865066c0b45e6253af77,da2c3a6847b7861493adb2c3716d43ca,dad4c63993550a10b53e7ee48aba10aa,dd5ded7a4790f110b8105052e36d43ed,dd8903b787400a10d6c70faf8bbb3541,de91f6501b77b5180857eb53604bcbb4,df7f7ef087ffbd50d6c70faf8bbb354c,dfad5f2387f721d03c4699f73cbb35ca,dfb068a5470f06509fbbc9a4116d4335,dfb6932b47810650f3050201516d43ec,dfe8ef569748c6d066c0b45e6253af24,e0f1926297a2b194b3e97c7e6253af1a,e1152e054795b510b8105052e36d4302,e1c67fda93539ad4f418b01e1dba1059,e2259c0147df86d093adb2c3716d43c0,e29582a247264a90f3050201516d43ab,e315656647f07d50b8105052e36d43ce,e39938f31bae7d940857eb53604bcb83,e4a9c30b93409a90f180f6ad1dba1061,e561f8af47340250dfcbaa6b416d4318,e6773ce7978c0a14b3e97c7e6253af90,e706aa49477c865493adb2c3716d43b6,e747210747b08e10036fa5cc416d43a9,e758e95b93361690f418b01e1dba109a,e7798f3c4754d6509fbbc9a4116d43b5,e83875da47e092989fbbc9a4116d436e,e84c871493e64250dca43c327cba10ba,e9984168931f0254244fbeedfaba1003,ea334da4474a92d0f3050201516d43bd,eac5e30f33186650028be7c13d5c7bfa,eb1d633047328e14f3050201516d4343,eb85f328470cae14f3050201516d431f,ec089ce847a1c290f3050201516d4348,ec08fa408716b110d6c70faf8bbb35e1,ec3bd47893bb1210dca43c327cba1045,ec69b1e44763ce1893adb2c3716d43a8,ec6f4a32930acad8dca43c327cba10d8,eca844e247c6b910b8105052e36d43fb,ed52e32593da8650dca43c327cba107f,ed58e95b93361690f418b01e1dba10d4,ee6a7f8b47258650305ca2e4116d43c4,ef06638647b1ced4f3050201516d43c3,eff7211893db1250f418b01e1dba1003,efff83e247318ed0305ca2e4116d4359,f12bc9bb47630e5093adb2c3716d43f9,f135d2cc9390dad0f180f6ad1dba106d,f15c729193bf52 ----------------------------------------- - The slow business rules observed in logs are a byproduct of this slowness: https://doitmarylandtest.service-now.com/sys_script_list.do?sysparm_query=nameSTARTSWITHCalculate%20MITRE%20Search%20Tag&sysparm_view= - The issue seems to have observed due to the number of records that we looked up in this transaction that took this amount of time. As you can observe: WARNING *** Large Table: Table handling an extremely large result set: 29024 Query that got us here is: TABLENAME = sn_ti_stix2_m2m_lookup_attack - Tried checking code search : https://code.devsnc.com/dev/app-sir-core/blob/b25a4dde890b02676daacdfe424876b27f866f89/app-sir/src/main/plugins/com.snc.security_incident/if/com.snc.threat/update/sys_script_include_4a30b88dd7c322007a6de294de610356.xml and its history but did not find any defects for it. - Checked with CS-perf. team locally here and they mentioned the SQL was ok but the feature / script has caused this slowness and that it needs to be reviewed by dev. team further as they are OOB version Knowledge Articles Researched:​ ​https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/security-incident-response/task/add-multiple-si-observables.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1100603",
      "parent_case": "CS8283452",
      "subject": "Unable to set Security Tags to be visible in Detection Rules - MITRE ATT&CK Mappings table [sn_ti_alert_rules_mitre_attack_technique_mapping]",
      "description": "------------------------------------​ Please conduct testing on OOB 'empajinkya' instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No ------------------------------------​ Assistance Requested: Need assistance to understand if this is intentional behavior or a product defect. ​ Affected instance(s): empajinkya​ Affected version(s): YP3​ Issue Definition: We are able to reproduce this issue in latest OOB instance where we are unable to set Security Tags to be visible in Detection Rules - MITRE ATT&CK Mappings table [sn_ti_alert_rules_mitre_attack_technique_mapping] We tried setting up Security tags UI Formatter in the Detection Rules - MITRE ATT&CK Mappings table (sn_ti_alert_rules_mitre_attack_technique_mapping), similar to the setup in Security Incidents table (Sn_si_incident) When we try to add the tag from the Security Tag formatter drop down in the Detection table record, the tag is not being visible, nor is the Security tag column of the corresponding detection record being filled with the tag. However, on checking the particular Security tag's \"Applied Security Tags\" via Security tag table (sn_sec_cmn_security_tag), we can see an entry. This is confusing, as we were expecting the Security tag to be visible in the Detection record and the Security tag column of the Detection record being populated with the added tag. Steps to Reproduce: 1. Hop on to 'empajinkya' OOB instance 2. Check security tag: SNC Test Tag : https://empajinkya.service-now.com/nav_to.do?uri=sn_sec_cmn_security_tag.do?sys_id=856c66a3fbede250cd49fb2d3eefdcd1 3. Go to ex record: https://empajinkya.service-now.com/nav_to.do?uri=sn_ti_alert_rules_mitre_attack_technique_mapping.do?sys_id=79fba663fbede250cd49fb2d3eefdcc3 or create new [sn_ti_alert_rules_mitre_attack_technique_mapping] with any sample data 4. Try to add Security tag 'SNC Test Tag' or any tag for that matter 5. Check on the tag related list \"Applied Security tag\", you can see a new record being generated but no info. about [sn_ti_alert_rules_mitre_attack_technique_mapping] record observed. Investigation Summary: ​ - The UI formatter needs to be configured to see the security tag toolbar : https://empajinkya.service-now.com/nav_to.do?uri=sys_ui_formatter.do?sys_id=958fa62bfbede250cd49fb2d3eefdc3c and brought into the form layout so its visible to select tag. - Plugins: sn_ti_ac : https://empajinkya.service-now.com/now/app-manager/home/app/id/f32170910b0222009f66e94685673a78/v/13.3.1/details v13.3.1 latest sn_si : https://empajinkya.service-now.com/now/app-manager/home/app/id/82878663ff123100158bffffffffff67/v/13.6.6/details Version: 13.6.2 latest - We can observe records being generated on [sn_sec_cmn_applied_security_tag] table when tag is applied : https://empajinkya.service-now.com/sn_sec_cmn_applied_security_tag_list.do?sysparm_query=security_tag%3D856c66a3fbede250cd49fb2d3eefdcd1&sysparm_view= Knowledge Articles Researched:​​ https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/threat-intelligence/concept/about-mitre-attack.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1066617",
      "parent_case": "CS8082590",
      "subject": "Request for Conditional Suppression of \"View Manual Runbook\" UI Action in SIR",
      "description": "-------------------------------------------------------------------------------------------------- Please conduct testing on omgcsdev instance only. SNC Access Control? Yes ---------------------------------------------------------------------------------------------------------- Debugging Permissions Instance Usage: PROD/SUB-PROD Is dev free to make modifications and test on instance for troubleshooting (provide scope of modifications which dev can do? : Yes If issues reproducible only on PROD, can we get a temp instance?Yes For issues around (Reconciliation/Integrations/Normalization/Content): Can dev run the relevant schedule jobs like Reconciliation/Integration/Normalization/Content pulls?Yes Affected instance(s): omgcsdev Affected version(s): Xanadu Patch 7 Upgrade History: Issue Definition: Customer has requested the ability to suppress the \"View Manual Runbook\" UI Action from displaying on Security Incident records when no matching entries exist in the sn_si_runbook_document table. This is being raised as a usability improvement rather than a functional defect. The behavior was first noticed during implementation reviews and is confirmed to occur in Out-of-Box environments. Assistance Requested: Would like product/UX input on whether this UI Action can be safely suppressed via conditional visibility logic Please reassign to UX next if needed after review by the product team Steps to Reproduce: 1. Navigate to a Security Incident record in SIR Workspace or classic UI. 2. Ensure the incident has no related entries in the sn_si_runbook_document table. 3. Observe that the \"View Manual Runbook\" UI Action is still present. 4. Click the action — it opens a dialog that returns no matches. Investigation Summary: • Behavior confirmed to match Out-of-Box implementation. • Currently no conditions tied to the presence/absence of data in sn_si_runbook_document. • A Teams message was posted to SWAT/UX team on 2025-04-01 requesting confirmation: https://teams.microsoft.com/l/message/19:dxg_nLZcz45megxv6a4wO1WyXZgt9V0VmU5U0C0Ao6g1@thread.tacv2/1743521834653?tenantId=8bcff170-9979-491e-8683-d8ced0850bad&groupId=9ea2a45b-7706-4f7e-8abc-8ec05ba4144d&parentMessageId=1743521834653&teamName=sir_swat-ServiceNow&channelName=General&createdTime=1743521834653",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1099921",
      "parent_case": "CS8287673",
      "subject": "Duplicate Task Observables are increasing the sighting count in Observable record but not creating the task observable record",
      "description": "********INCIDENT TASK CREATED******** ------------------------------------ Please conduct testing on instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Please confirm if this is a defect Affects instance(s): empjciba3 (Employee Instance) Version(s): glide-washingtondc-12-20-2023__patch10-hotfix2a-03-13-2025 Steps to Reproduce: 1. open sn_ti_m2m_task_observable table 2. click on new button 3. select existing observable and existing task 5. click on submit 6. error pop us up that invalid input 7. linked observable sighting count increased Investigation Summary: I am able to reprpoduce the issue OOTB Before the check to insert duplicate happens, below BR is getting triggered which updates the incident count in sn_si_observable table https://shelldev2.service-now.com/nav_to.do?uri=sys_script.do?sys_id=884a4698678322002e640731b2415ad8 As the insert into sn_ti_m2m_task_observable table is aborted, we should not allow to update the incident count in observable table",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1098065",
      "parent_case": "CS8289278",
      "subject": "Process Capability Implementations is creating thousands of Flow Executions",
      "description": "------------------------------------ Please conduct testing on n/a instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: We need assistance understanding why scheduled job Process Capability Implementations is creating thousands of flow executions Affected instance(s): irisdva Affected version(s): XP7a Issue Definition: Customer is reporting a massive amount of Flow executions in queue state Steps to Reproduce: In Navigator, Go to Process Automation -> Flow Designer -> Flow Administration -> Today's Executions Filter by state=queued Observe that just for today, there are more than 1 Million of records Investigation Summary: There are 1M of flow context for Flow Netskope - Threat Lookup https://irisdva.service-now.com/sys_flow_context_list.do?sysparm_query=sys_created_on%3E%3Djavascript%3Ags.dateGenerate('2025-05-16'%2C'00%3A00%3A00')%5Estate%3DQUEUED%5Eflow%3D54476893db76795029cae6ccd39619d6&sysparm_view= The source of that flow is scheduled job: Process Capability Implementations that runs every 10 secs https://irisdva.service-now.com/nav_to.do?uri=sysauto_script.do?sys_id=bb1b17570b90001099b8ea7885673a07 Subflow: Netskope - Threat Lookup https://irisdva.service-now.com/now/workflow-studio/builder%3Ftable%3Dsys_hub_flow%26sysId%3D54476893db76795029cae6ccd39619d6 It seems that the subflow is part of a custom application : Netskope App for Security Incident Responder - x_netsk_nets_sir The subflow is triggered by the scheduled job that does not seem to be custom but rather part of SN application : Security Support Common The issue started to happen on Friday last week (5/16) The customer states that every day there are some flow contexts in queue but they get processed eventually and the list of queue records do not keep growing but on Friday that did not happen Knowledge Articles Researched: https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/security-operations-common/concept/get-running-processes-capability.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1097541",
      "parent_case": "CS8216964",
      "subject": "Unzip flow util (OOB) fails to unzip the files",
      "description": "------------------------------------​ Please conduct testing on bnppdev3 instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? Yes/No​ - Yes ------------------------------------​ Assistance Requested: Unzip flow util (OOB) fails to unzip the files​ Affected instance(s): bnppdev3 ​ Affected version(s): Xanadu Patch 7​ Steps to Reproduce: - In the bnppdev3 instance - Open the flow context https://bnppdev3.service-now.com/now/workflow-studio/builder?table=sys_flow_context&sysId=268995a22e6dae906f8a4cbb184d3c7e - Open the Attachment Unzip - Security Incident - Check the logs https://bnppdev3.service-now.com/sys_flow_log.do?sys_id=368995a2336dae90e7646b42cd5c7bf7 Crypto module access is denied for an attachment: com.glide.kmf.CryptoModuleAccessDeniedException: Crypto module access is denied for an attachment: Investigation Summary: ​ 1)Reviewed the KMF health page.it is working as expected . 2)Checked the logs, we could se error related to KMF module. 3)Reviewed the Error logs of the flow from flow designer 4)Checked with Integrations team and they suggested toc heck with TSM as error is related to look up record. Flow details: Flow Used : UnZip security incident files. Flow Action : Attachment Unzip - Security Incident. Encountered error executing instruction: ActionErrorEvalInstruction{id=8, conditions=[], statusKey=c1o.__action_status__, dontTreatAsErrorKey=c1o.__dont_treat_as_error__}, errorMessage:No record found in Look Up Record action. Context id: 6bdb88a1848dea54665d000c5a8e592e, table: sn_si_incident, encoded query: sys_id=c5f111643ba8aa1077712b0c95e45a1e, errorCode:1 5)We have verified the action, it is an OOB action coming from SIR module https://bnppdev3.service-now.com/sys_hub_action_type_definition_list.do?sysparm_nostack=true&sysparm_query=nameLIKEAttachment%20Unzip&sysparm_first_row=1&sysparm_view=&sysparm_choice_query_raw=&sysparm_list_header_search=true",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1088462",
      "parent_case": "CS8247494",
      "subject": "Security Operations Spoke - ThreatStream Integration - Unable to Create Sub Flow for Integration Capability For Threat Lookup",
      "description": "- ------------------------------------ Please conduct testing on ven06726 instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: I met with the customer and they are having an issue implement a subflow. Should this be realigned to integration? I need assistance providing documentation or knowledge on how they should setup their subflow. Affected instance(s): ven06726 Affected version(s): Washington DC Patch 10 Hot Fix 2 Issue Definition: Customer Zoom Rec Link: https://servicenow.zoom.us/rec/play/JmVglmKGp7MTdNbYLzLbgwkkVh06sG0ChsMZs-RLMK1I4WUMsYdiZf0qCYXOXQtpdI90HDNC6-To0os7.DZPotFYbKPwGhkfk Customer is trying to implement the following subflow and the inputs are not working Application: ThreatStream Integration Flow: ThreatStream Enrichment They would like to understand what the inputs should be or why they are not working. They also mentioned they assume Enrich Observables V1 is what calls their implementation of the enrichment. OOB Application: Security Operations Spoke Flow: Enrich Observables V1 Customer Description: We have been trying to migrate our Workflows for things Threat Lookup in our SecOps Application to Capability Implementations and Flows to make it compatible with Yokohama. I have started with migrating our Threat Lookup and have ran into issues with the Input and Output variables. I have checked the Security Incident Response Integration Capabilities guide to determine the Input Variables that are required but when I try to execute the Threat Lookup I see this error in the system logs: Error running flow: x_228326_ts_enrich.threatstream_threat_lookup msg: com.glide.plan.runners.FlowObjectAPIException: The inputs provided to the subflow: ThreatStream Threat Lookup within application scope: x_228326_ts_enrich are incorrect, please refer to the definition Is the issue reproducible OOB? No Steps to reproduce: Node Logs: What has changed: PRBs/Cases Researched:",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1096878",
      "parent_case": "CS8282538",
      "subject": "Case assistance - Emails with attachment type .rpmsg are not getting converted to security incidents response ticket",
      "description": "Issue Summary: BD Information Security Mailbox received a new email, but SIR did not create a new incident ticket for it. The email was received by ServiceNow but did not proceed, even though it matched the ingestion rule. Affected instance:bdqa SNC access required:Washington DC Patch 10 Hot Fix 2a Version:NO Steps to Reproduce: Reprocess the email below, and you will not find the SIR ticket being created. https://bdqa.service-now.com/nav_to.do?uri=sys_email.do?sys_id=1eb192aa47adea142c558c29736d431f https://bdqa.service-now.com/nav_to.do?uri=sys_email.do?sys_id=453756763329221485c608959d5c7be3 Steps Taken: - Looking at the email logs Create Phishing Email inbound action is getting picked up, but for some reason, it writes the below message 2025-05-19 10:23:50 (720) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Create Phishing Email : did not create or update sn_si_phishing_email using current - Noticed the following logs related to caller restricted access hence updated the same as per the attached screenshot 2025-05-19 08:25:45 (440) worker.4 worker.4 txid=bbb11e26336d Log WARNING *** WARNING *** Security restricted: Unable to identify source of the Read operation on table 'sn_si_incident' from scope 'Global'. No Restricted Caller Access privilege records were created. The operation was allowed because target resource RCA policy is set to 'Tracking', but will be blocked with the 'Restricted' policy. Please contact the application admin. 2025-05-19 08:25:45 (439) worker.4 worker.4 txid=bbb11e26336d CrossScopeAccessBase SEVERE *** ERROR *** Source descriptor is empty while recording access for table sn_si_incident 2025-05-19 08:25:45 (413) worker.4 worker.4 txid=bbb11e26336d LocalhostTransactionLogger *** Start Background transaction - system, type: other, user: system - Updated the caller restricted access and started seeing below WARNING *** ScopedRhinoObjectWrapper: not a wrappable type: com.glide.notification.inbound.classify.EmailClassifier 2025-05-19 10:23:50 (951) worker.4 worker.4 txid=99cc6aee47a9 JobExecutor Completed: events process 0 in 0:00:01.403, next occurrence is 2025-05-19 17:23:57, id=679b04304711221075ca124c736d43d7 tr=10 pr=25 re=10 po=1747675429 la=0.005 c=t 2025-05-19 10:23:50 (947) worker.4 worker.4 txid=99cc6aee47a9 EventManager Skipped 0 events as shutdown is in progress. 2025-05-19 10:23:50 (943) worker.4 worker.4 txid=99cc6aee47a9 DBTrace Time: 0:00:00.217 id: bdqa_1[glide.9] primary_hash=-835030094 (connpid=895759) for: SELECT label0.`short_description`, label0.`color`, label0.`icon`, label0.`global`, label0.`sys_updated_on`, label0.`type`, label0.`sys_class_name`, label0.`max_entries`, label0.`home_page`, label0.`sys_id`, label0.`navigation`, label0.`sys_updated_by`, label0.`sys_created_on`, label0.`viewable_by`, label0.`sys_default`, label0.`sys_created_by`, label0.`order`, label0.`owner`, label0.`sys_mod_count`, label0.`active`, label0.`user_list`, label0.`group_list`, label0.`background_color`, label0.`name` FROM label label0 WHERE (label0.`active` = 1 AND label0.`type` = 'standard' AND (label0.`owner` = 'mathankumar.r@snc' OR label0.`global` = 1)) /* bdqa029, gs:glide.scheduler.worker.4, tx:99cc6aee47a9a21475ca124c736d4385, hash:-835030094 */ 2025-05-19 10:23:50 (721) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Stop processing detected after executing script: Create Phishing Email 2025-05-19 10:23:50 (720) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Create Phishing Email : did not create or update sn_si_phishing_email using current 2025-05-19 10:23:50 (719) worker.4 worker.4 txid=99cc6aee47a9 IES_90b455f60b12330099b8ea7885673a80 Background message, type:error, message: Function log is not allowed in scope sn_sec_cmn. Use gs.debug() or gs.info() instead 2025-05-19 10:23:50 (716) worker.4 worker.4 txid=99cc6aee47a9 SSI_b2727f120bc2330099b8ea7885673a18 sn_sec_cmn (EmailUserReportedPhishing): Create Phishing Email _processEmailAttachments_while 2025-05-19 10:23:50 (713) worker.4 worker.4 txid=99cc6aee47a9 SSI_b2727f120bc2330099b8ea7885673a18 sn_sec_cmn (EmailUserReportedPhishing): Create Phishing Email _processEmailAttachments 2025-05-19 10:23:50 (711) worker.4 worker.4 txid=99cc6aee47a9 SSI_b2727f120bc2330099b8ea7885673a18 sn_sec_cmn (EmailUserReportedPhishing): Create Phishing Email:SI-inside _ProcessEmail_1 2025-05-19 10:23:50 (708) worker.4 worker.4 txid=99cc6aee47a9 IES_90b455f60b12330099b8ea7885673a80 sn_sec_cmn (): Create Phishing Email - inside Inbound Action 2025-05-19 10:23:50 (706) worker.4 worker.4 txid=99cc6aee47a9 AScopedObjectWrapper WARNING *** WARNING *** ScopedRhinoObjectWrapper: not a wrappable type: com.glide.notification.inbound.classify.EmailClassifier 2025-05-19 10:23:50 (654) worker.4 worker.4 txid=99cc6aee47a9 AScopedObjectWrapper WARNING *** WARNING *** ScopedRhinoObjectWrapper: not a wrappable type: com.glide.notification.inbound.classify.EmailClassifier 2025-05-19 10:23:50 (590) worker.4 worker.4 txid=99cc6aee47a9 SecurityLogFileHandler event=\"ACTIVATE_ELEVATE_ROLE\" elevated_roles=\"security_admin\" log_type=\"SECLOG\" tx_num=\"36868286\" url=\"events process 0\" available_elevated_roles=\"security_admin\" domain=\"global\" http_last_time=\"\" user=\"system\" user_id=\"system\" http_time_zone=\"US/Eastern\" user_group=\"n/a\" http_browser=\"unknown\" 2025-05-19 10:23:50 (590) worker.4 worker.4 txid=99cc6aee47a9 ContextualSecurityManager Enabling elevated role: security_admin 2025-05-19 10:23:50 (545) worker.4 worker.4 txid=99cc6aee47a9 SecurityLogFileHandler event=\"ACTIVATE_ELEVATE_ROLE\" elevated_roles=\"security_admin\" log_type=\"SECLOG\" tx_num=\"36868286\" url=\"events process 0\" available_elevated_roles=\"security_admin\" domain=\"global\" http_last_time=\"\" user=\"system\" user_id=\"system\" http_time_zone=\"US/Eastern\" user_group=\"n/a\" http_browser=\"unknown\" 2025-05-19 10:23:50 (545) worker.4 worker.4 txid=99cc6aee47a9 ContextualSecurityManager Enabling elevated role: security_admin 2025-05-19 10:23:50 (349) worker.4 worker.4 txid=99cc6aee47a9 ContextualSecurityManager Enabling elevated role: security_admin 2025-05-19 10:23:50 (346) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Skipping script 'Create Enhancement', email is type 'forward', which does not match Inbound Email Action's type 'new' 2025-05-19 10:23:50 (290) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Trigger 6524138b1bd61910cf38dd77bd4bcbcc email conditions not satisfied, skipping 2025-05-19 10:23:50 (213) worker.4 worker.4 txid=99cc6aee47a9 SysLog EMAIL.1eb192aa47adea142c558c29736d431f: Email is classified as forward for triggers execution 2025-05-19 10:23:49 (771) worker.4 worker.4 txid=99cc6aee47a9 DBTrace Time: 0:00:00.217 id: bdqa_1[glide.26] primary_hash=-835030094 (connpid=895776) for: SELECT label0.`short_description`, label0.`color`, label0.`icon`, label0.`global`, label0.`sys_updated_on`, label0.`type`, label0.`sys_class_name`, label0.`max_entries`, label0.`home_page`, label0.`sys_id`, label0.`navigation`, label0.`sys_updated_by`, label0.`sys_created_on`, label0.`viewable_by`, label0.`sys_default`, label0.`sys_created_by`, label0.`order`, label0.`owner`, label0.`sys_mod_count`, label0.`active`, label0.`user_list`, label0.`group_list`, label0.`background_color`, label0.`name` FROM label label0 WHERE (label0.`active` = 1 AND label0.`type` = 'standard' AND (label0.`owner` = 'mathankumar.r@snc' OR label0.`global` = 1)) /* bdqa029, gs:glide.scheduler.worker.4, tx:99cc6aee47a9a21475ca124c736d4385, hash:-835030094 */ 2025-05-19 10:23:49 (543) worker.4 worker.4 txid=99cc6aee47a9 LocalhostTransactionLogger *** Start Background transaction - system, type: other, user: system ➢ Docs referred: ↳ https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/security-incident-response/concept/urp-about.html Next Steps: Requesting assistance to clarify the reason why the attachments from the below email are not getting converted to SIR ticket ↳ https://bdqa.service-now.com/nav_to.do?uri=sys_email.do?sys_id=1eb192aa47adea142c558c29736d431f 1. Is the .rpmsg file type supported? The product documentation below mentions that \"Users can upload a phishing email (in .eml format).\" ↳ https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/security-incident-response/concept/urp-about.html 2. If the .rpmsg type is accepted as received in the email, please help identify the reason for the failure to create the SIR type.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1096815",
      "parent_case": "CS8281134",
      "subject": "Auto assignment of SOC analyst Workflow is not executing for newly created SIR sometimes -  previous task CSTASK1076388",
      "description": "*******CASE TASK SUMMARY******** ------------------------------------ Please conduct testing on these instances only. - mymaxis (production) The customer has authorized access/changes to other instance(s.) - NO SNC Access Control? NO ------------------------------------ Assistance Requested: Auto assignment of SOC analyst Workflow is not executing for newly created SIR sometimes ------------------------------------ Affected instance(s): mymaxis ------------------------------------ Affected version(s): Washington DC Patch 9b ------------------------------------ ----------------------------------------------- Issue Definition: ----------------------------------------------- Auto assignment of SOC analyst Workflow is not executing for newly created SIR sometimes ----------------------------------------------- Steps to Reproduce: ----------------------------------------------- --> The Splunk alerts are created from a third-party tool into the SIR tickets. --> Non-Working Scenario - SIR0075571 https://mymaxis.service-now.com/now/nav/ui/classic/params/target/sn_si_incident.do%3Fsys_id%3Db59848d44781aa10944cbaf4116d4319%26sysparm_record_target%3Dsn_si_incident%26sysparm_record_row%3D8%26sysparm_record_rows%3D62098%26sysparm_record_list%3DORDERBYDESCnumber --> Working - SIR0075578 https://mymaxis.service-now.com/now/nav/ui/classic/params/target/sn_si_incident.do%3Fsys_id%3D4211fc909349aa94f789705efaba1007%26sysparm_record_target%3Dsn_si_incident%26sysparm_record_row%3D1%26sysparm_record_rows%3D1%26sysparm_record_list%3DnumberSTARTSWITHSIR0075578%255EORDERBYDESCnumber ----------------------------------------------- Investigation Summary: ----------------------------------------------- --> Call recording with the customer - https://servicenow.zoom.us/rec/play/sLSrfdFO2UfDKp-cUuHK45YtMXZ1P-CvfDuvOqodkfb6rVVtytdJxc6UvsAQFDYV6Ek_lAGWpB6FyZiA.2nqFrZuttIpEjqtj\\ --> SIR0075571 was not automatically assigned using the Trigger Rule. The Trigger rule was run, but the workflow did not get executed. --> The Issue was not reproduced on the DEV instance. The mid servers only run during office hours in the sub-prod instances. i.e. 6 AM to 3.30 PM (currently it is till 9 PM for development work ongoing) --> On- call Calendar https://mymaxis.service-now.com/now/nav/ui/classic/params/target/%24oc.do%3Fsysparm_include_view%3Ddaily%2Cweekly%2Cmonthly%26sysparm_timezone%3DAsia%252FKolkata%26sysparm_current_view%3Dmonthly%26sysparm_start_date%3D2025-04-17%26sysparm_timeline_enabled%3Dfalse%26sysparm_group_id%3Ddea26263ff0331007a6dffffffffff19%26sysparm_rotas%3D17cffebadb0a09100fe5586dd3961974%2C5fcffebadb0a09100fe5586dd3961977%2C9bcff2badb0a09100fe5586dd3961956%26sysparm_rosters%3D180083fadb0a09100fe5586dd3961989%2C1c0083fadb0a09100fe5586dd396198f%2Cd40083fadb0a09100fe5586dd3961982%26sysparm_show_gaps%3Dtrue%26sysparm_show_conflicts%3Dtrue --> Event for SIR0075571 (Non-Working) https://mymaxis.service-now.com/nav_to.do?uri=sysevent.do?sys_id=a759181c4705ea10944cbaf4116d43ed --> Node logs attached for both working and non-working transactions --> Recursive business rule found in Transaction in node logs for SIR0075571 2025-04-17 02:08:47 (602) worker.4 worker.4 txid=1d9848d44781 SSI_6837ba4547b3200042bd757f2ede2750 Cannot disable before query business rule(s) across scope boundaries (current scope: rhino.global table scope: sn_si) 2025-04-17 02:08:47 (660) worker.4 worker.4 txid=1d9848d44781 SSI_6837ba4547b3200042bd757f2ede2750 Recursive business rule call for 'Trigger Workflows' on sn_si_incident:<span class = \"session-log-bold-text\"> SIR0075571</span> is being ignored. Business Rule Stack: Transform synchronously,Trigger Workflows,Roll Up Changes,Trigger Workflows----- --> There is no difference in the way of creation for both SIRs --> Based on suggestion from CSTASK1076388 Customer tried deleting the record as per your suggestion but right after it caused another issue that play book for security incidents were not getting attached/ triggered. Then we roll back the changes and make them as usual. So the solution proposed caused another issue that is the reason raised one more case as issue is not resolved as existing case got closed",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1093569",
      "parent_case": "CS8241015",
      "subject": "Unable to see the POST or messages that are updated on the team's channel for the Major security incident record [Teams Integration]]",
      "description": "Assistance Requested: Unable to see the POST or messages that are updated on the team's channel for the Major security incident record [Teams Integration]] Affected instance(s): cobaentw1 Affected version(s): __VERSION_HERE__ Issue Definition: Unable to see the POST or messages that are updated on the team's channel for the Major security incident record [Teams Integration]] Steps to Reproduce: ( In Dev – https://cobaentw1.service-now.com/ ) 1.Log in as Admin user 2.open any security incident and from the context menu click on promote to major security incident 3.which will then give and info message with the MSIM record number 4.Now navigate to Major security incident management workspace -> navigate to proposed list 5.Open the proposed record and click on Ui action \"Promote to major security incident\" 6.There will be a collaboration tab displayed on the workspace record, and you see the chat channels 7.From the chat channels click on IMT channel and add yourself as user to receive the channel on the Microsoft teams 8. Now go to microsoft.teams.com 9. MSIM record will be displayed on your teams and now try to post any comment from the teams which should be displayed into the MSIM record in collaboration tab , but that not getting displayed in our instance Note: This can be reproduced over the call with the help of customer. Investigation Summary: [] As per the reproducible steps the comments should be posted in the respective MSIM record activity log but that is not happening. [] While reproducing the issue scenario, we could see the Channel is getting created and MSIM getting created but the comments or posts from the teams are not syncing to MSIM record. [] We could see few Flows are also getting trigged only for record creation and channel creation. [] This is the respective Plugin for this set up: Major Security Incident Management https://cobaentw1.service-now.com/now/app-manager/home/app/id/d591deb12806201057b7a6460e6132c3/v/3.4.2/details [] After the investigation, we identified the exact issue has reported as a PRB. PRB for reference: PRB1547152 https://support.servicenow.com/nav_to.do?uri=problem.do?sys_id=a5011e3b1b50cd50af5eece7624bcb1c KB for reference: https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1001224 [] Requested them to apply the workaround by applying the update set. [] They have tried the same but that didn't helped. [] Requested customer to upgrade below plugins to the latest versions and see if that helps! Plugin: Major Security Incident Management https://cobaentw1.service-now.com/now/app-manager/home/app/id/d591deb12806201057b7a6460e6132c3/v/3.4.2/details Plugin: Microsoft Teams Chat Connector for Security Incident Management https://cobaentw1.service-now.com/now/app-manager/home/app/id/0b5d2e0b7222201086e0774d5b029483/v/1.2.12/details [] They have tried it, but that also didn't helped. Need quick assistance on this, as this impacting on the Prod..",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1095104",
      "parent_case": "CS8281007",
      "subject": "Swarm: Troubleshooting Assistance - SIR records are not getting created for few Azure Sentinel Profiles.",
      "description": "REQUEST: For the below Azure Sentinel Integration profiles, SIR records are not getting created from 8th of May.: RACQ (https://spirit.service-now.com/sn_sec_sentinel_incident_profile.do?sys_id=421bcf56c37f1250c90997aa05013108&sysparm_record_target=sn_sec_sentinel_incident_profile&sysparm_record_row=9&sysparm_record_rows=13&sysparm_record_list=ORDERBYorder) INVESTIGATION SUMMARY: 1. Checked on the profile and observed that the state is in 'Running' stage. 2.Checked on the 'sn_si_incident' table and from 8th of May, no new records are been created for RACQ profile. (https://spirit.service-now.com/sn_si_incident_list.do?sysparm_query=sys_created_on%3Ejavascript:gs.dateGenerate(%272025-05-06%27%2C%2723:59:59%27)%5Eu_enforced_view_location.u_customer_nameLIKERACQ%5Econtact_type%3DMicrosoft%20Sentinel&sysparm_first_row=1&sysparm_view=) 3. Also checked on the 'sn_sec_sentinel_incident_raw' table and observed that no new Raws are been created for the same profile. (https://spirit.service-now.com/sn_sec_sentinel_incident_raw_list.do?sysparm_query=sys_created_on%3Ejavascript:gs.dateGenerate(%272025-05-08%27%2C%2723:59:59%27)%5Eprofile.nameLIKERACQ&sysparm_first_row=1&sysparm_view=&sysparm_choice_query_raw=&sysparm_list_header_search=true) 4. Filtering and Aggregation section don't have any specific filter that are been added. 5.Checked on system log and splunk log to see any error for this profile, however couldn't find any : https://splunk.servicenow.net/en-US/app/search/search?earliest=1746655200&latest=1747432800&q=search%20instance%3Dspirit%20%22RACQ%20%7C%20Azure%20Sentinel%20Profile%22&sid=1747394433.149671_859D5165-8F33-47F1-8408-E28FC6540AB8&display.page.search.mode=verbose&dispatch.sample_ratio=1 6. In UAT as well, the SIR's are not getting created. AFFECTED INSTANCES: spirit STEPS TO REPRODUCE: 1. Redirect to the SIR records and sort it out by created date, you can see that the last ticket was created on 7th : https://spirit.service-now.com/sn_si_incident_list.do?sysparm_query=sys_created_on%3Ejavascript:gs.dateGenerate(%272025-05-06%27%2C%2723:59:59%27)%5Eu_enforced_view_location.u_customer_nameLIKERACQ%5Econtact_type%3DMicrosoft%20Sentinel&sysparm_first_row=1&sysparm_view= 2. Check the profile RACQ https://spirit.service-now.com/sn_sec_sentinel_incident_profile.do?sys_id=421bcf56c37f1250c90997aa05013108&sysparm_record_target=sn_sec_sentinel_incident_profile&sysparm_record_row=9&sysparm_record_rows=13&sysparm_record_list=ORDERBYorder",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1095100",
      "parent_case": "CS8277905",
      "subject": "Clarification on \"Threat Level\" and \"Threat Severity\" in TISC",
      "description": "------------------------------------​ Please conduct testing on nisctispdev instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No​ ------------------------------------​ Assistance Requested: Question about fields Affected instance(s): nisctispdev​ Affected version(s): Xanadu P7a ​ Threat Intelligence Security Center for Security Operations - 3.8.0 App id: sn_sec_tisc Issue Definition: 1. Clarification on Setting \"Threat Level\" and \"Threat Severity\" : \"Threat Level\" and \"Threat Severity\" are displayed in Observable, Vulnerability and Threat Event. - Is it expected that the end users set the \"Threat Level\" and \"Threat Severity\"? - Or are these values assigned in ServiceNow based on information from each threat intelligence source? - How are these values intended to be used in ServiceNow? 2. The Difference between \"Threat Level\" and \"Threat Severity\" : - The end user needs clarification on the difference between \"Threat Level\" and \"Threat Severity\" as it is not documented in the referenced materials. Define an Observable https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-threat-security-center/task/define-an-observable.html -> Threat Level - Indicates the threat level of the observable record. Threat Severity - Indicates the threat severity of the observable record. Define Vulnerability https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-threat-security-center/task/define-vulnerability.html -> There is no document about both \"Threat Level\" and \"Threat Severity\" Define Threat Event https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-threat-security-center/task/define-threat-event.html?state=seamless ​-> There is no document about both \"Threat Level\" and \"Threat Severity\" Steps to Reproduce: 1. Open ​Observable, Vulnerability or Threat Event in Threat Intelligence Security Center 2. \"Threat Level\" and \"Threat Severity\" are displayed. Investigation Summary: ​ 1. There is no documentation about both fields in details. Knowledge Articles Researched:​ No KB has been reported yet.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1074147",
      "parent_case": "CS8048495",
      "subject": "Splunk ES Integration the incident status is not getting closed at splunk side",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on mymaxis instance only OR This issue is only available in PROD: __FILL_IN_PROD_NAME_HERE__ The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Need help in checking why the Splunk ES Integration, the incident status is not getting closed at splunk side where as it shows closed in ServiceNow. Affected instance(s): mymaxis Affected version(s): Washington DC Patch 9a Issue Definition: When we update the status of SIR to closed in ServiceNow, the incident status is not getting closed on Splunk side. Steps to Reproduce: NA Investigation Summary: Store app name and version: \"Splunk ES Integration for Security Operations 12.2.1 version\" customer is using \"Splunk ES Integration for Security Operations 12.2.1 version\" integration and they are facing the issue, whenever the SIR is closed in servicenow the same SIR was not closed at the splunk side. This issue is intermittent. I have checked the Outbound HTTP request, we can see the request body contains status code 5 which is closed as per splunk and response status as 200. Attached screenshot for reference. But the SIR is still not closed at splunk side. >>we are sending the correct status code (5) intended to close the SIR, and it is reflected accurately in the payload. >> ServiceNow is also receiving a 200 OK HTTP response from Splunk From the logs, we could see that when the incident is getting created, we send the response as status 2, but when the incident is closed, we send the status as 5 which is expected as per Splunk. Outbound HTTP logs: https://mymaxis.service-now.com/sys_outbound_http_log_list.do?sysparm_query=sys_created_onONLast%20month%40javascript%3Ags.beginningOfLastMonth()%40javascript%3Ags.endOfLastMonth()%5EurlLIKEnotable_update%5Ehostname%3Dsplunksh.men.maxis.com.my%5Erequest_bodyLIKEef3b5bd093a46610f789705efaba107a&sysparm_view= Please check the attached screenshots for reference. SIR0073684 Logs: https://mymaxis.service-now.com/sys_outbound_http_log_list.do?sysparm_query=sys_created_onBETWEENjavascript%3Ags.dateGenerate('2025-03-13'%2C'00%3A00%3A00')%40javascript%3Ags.endOfToday()%5EurlLIKEnotable_update%5Ehostname%3Dsplunksh.men.maxis.com.my%5Erequest_bodyLIKESIR0073684&sysparm_view= SIR0074315 Logs: https://mymaxis.service-now.com/sys_outbound_http_log_list.do?sysparm_query=sys_created_onBETWEENjavascript%3Ags.dateGenerate('2025-03-13'%2C'00%3A00%3A00')%40javascript%3Ags.endOfToday()%5EurlLIKEnotable_update%5Ehostname%3Dsplunksh.men.maxis.com.my%5Erequest_bodyLIKESIR0074315&sysparm_view= From the above links, we can see one log with a Response body contains \"status 2\" which is when an incident is created and the second log with Response body status 5 indicates the incident is closed. ====== I have asked customer to work with splunk support as we send the correct Request body and we received response status as 200 from splunk. Also asked customer to capture the payload that they received from servicernow but they said splunk will not capture any payload and it will directly update the SIR. Is there anything that we can help customer from servicenow? Reviewed with dev in team channel, team suggested to raise a task to debug more on this issue. https://teams.microsoft.com/l/message/19:dxg_nLZcz45megxv6a4wO1WyXZgt9V0VmU5U0C0Ao6g1@thread.tacv2/1744268636544?tenantId=8bcff170-9979-491e-8683-d8ced0850bad&groupId=9ea2a45b-7706-4f7e-8abc-8ec05ba4144d&parentMessageId=1744268636544&teamName=sir_swat-ServiceNow&channelName=General&createdTime=1744268636544",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1093340",
      "parent_case": "CS7843255",
      "subject": "User without sn_si.admin role should not be able to assign a role to another user when impersonating a user who has sn_si.admin role",
      "description": "<<---UX Support to Dev Task Template (Do Not Remove)-->> ------------------------------------------------------------------------------------------------------ Please conduct testing on the instance- ON-PREM instance issue. The customer has NOT authorized access/changes to other instance(s.) If the issue is only on Production instance, do we have permission from the customer to test / edit? [No] SNC Access Control? [Yes] ------------------------------------------------------------------------------------------------------ Assistance Requested: Troubleshooting assistance - User without sn_si.admin role should not be able to assign a role to another user when impersonating a user who has sn_si.admin role Affected instance(s): Washington DC Affected version(s): Patch 8 Issue Definition: User without sn_si.admin role should not be able to assign a role to another user when impersonating a user who has sn_si.admin role Steps to Reproduce: 1)an admin user which is not a member of custom group(\"SIR - Security Administrators\") with \"sn_si.admin\" role. 3)this admin user can not add himself to this custom group. 3)when this admin impersonates a member of this custom group, he can add himself to this custom group. Expected behavior: User without sn_si.admin role should not be able to assign a role to another user when impersonating a user who has sn_si.admin role Actual behavior: User without sn_si.admin role can assign a role to another user when impersonating a user who has sn_si.admin role Is the Issue Reproducible out of the box? [NO] Investigation Summary: <List all analysis, troubleshooting done so far, including dead ends and evidence collected, and use attachments for large files> Asked the below to get logs, and the user was able to fix the issue, but the below is not an actual fix. 1) Under the system property table -> \"glide.ui.schedule_slushbucket_save_for_group_roles\" and if it's set to \"true\", then please set it to \"false\". 2) Log out and log back in 3) Reproduce the issue, i.e., impersonate the user and assign the group as you demonstrated in the call 4) Node logs attached to the case task 5) This step was performed as part of testing, where we wanted to check the logs, so we asked the customer to set the below property to \"false,\" which solved the issue, but was not part of the actual solution. \"glide.ui.schedule_slushbucket_save_for_group_roles\" 6) Raised CSTASK1081820 with the UX SME and was asked to reach out to APP-SIR-SHIELD with the below details As far as I can see, the member assignment is limited by the role \"sn_si.manager\" based on the scoped ACL: <INSTANCE>/nav_to.do?uri=sys_security_acl.do?sys_id=2fdf1b5eff4202007a6dfffffffffff7 Since there is no check for impersonation in the ACL, the admin user can add himself by impersonating a member of the group. I am not sure how the \"glide.ui.schedule_slushbucket_save_for_group_roles\" system property made a change here. When I checked this in the W release, I can see the same behavior. I have used \"demonightlysir\" instance to check which is also in W, and the customer's instance is also WP8 List any useful KB, PRB, Docs, if applicable: (which might be related to this issue) Recording of the issue - https://servicenow.zoom.us/rec/play/FEaNsNZIFhwmM70yrA_T8AOk1BbP6ro8ocaOLQkScqGTxFPriv6rlVS0JUPwpCs-Rg7P7CFrmscDhXbJ.BpFWuWzsw7NoWoiY",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1091349",
      "parent_case": "CS8226004",
      "subject": "[TISC] Need to clarify which columns are inherited from sn_sec_tisc_vulnerability_source to sn_sec_tisc_vulnerability",
      "description": "*** Please do not make any changes to the system without the customer's approval whether prod or sub-prod. *** If you need to make changes to the system, please provide the customer the steps to change and get their approval in advance. *** If you made any changes to the system, please be sure to undo them. *** Changing the lang from Japanese to English using property \"glide.sys.language\" causes unexpected behaviors in English for the customers if the property value remains. *** It would be better for maint user to change the lang in your session only. *** For detail, please refer to KB1765763 and KB1704264 *** *** KB1765763 [JLS] How to change the translated language to English in your session only *** KB1704264 [JLS] How to revert changes done on customer's instances ------------------------------------ Please conduct testing on nisctispdev instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Please clarify which columns are inherited from Vulnerability Source to Vulnerability. Affected instance(s): nisctispdev Affected version(s): Xanadu Patch7 Ver of Threat Intelligence Security Center for Security Operations (App id: sn_sec_tisc) : 3.8.0 Issue Definition: Based on following doc, customer understands that Vulnerability Source(sn_sec_tisc_vulnerability_source) will be inherited to Vulnerability(sn_sec_tisc_vulnerability) --------- TISC Data Processing Functional Flow > TISC Data Flow https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-threat-security-center/concept/tisc-data-processing-functional-flow.html#d571764e79 --------- But not sure which columns are inherited from Vulnerability Source(sn_sec_tisc_vulnerability_source) to Vulnerability(sn_sec_tisc_vulnerability). For example, customer confirmed \"CVSS2.0\" of Vulnerabilityis (sn_sec_tisc_vulnerability.cvss_20) is updated from new source(sn_sec_tisc_vulnerability_source.cvss_20). But \"Additional Context\" (sn_sec_tisc_vulnerability.sn_sec_tisc_vulnerability) is not updated from new source(sn_sec_tisc_vulnerability.sn_sec_tisc_vulnerability) So would you please clarify which columns are inherited from Vulnerability Source to Vulnerability ? Steps to Reproduce: 1.Execute sn_sec_tisc_vulnerability_source.list and filter by Name:CVE-2024-0545 2.Execute sn_sec_tisc_vulnerability.list and filter by Name:CVE-2024-0545 3.Compare each columns ==> \"CVSS2.0\" of Vulnerabilityis is updated from new source. But \"Additional Context\" is not updated from new source. Investigation Summary: 1.I checked our documentations, KB articles and old cases but was not able to find any information about relationship of columns between sn_sec_tisc_vulnerability_source and sn_sec_tisc_vulnerability. Knowledge Articles Researched: KB1587756 Threat Intelligence Security Center Entities De-duplication logic CSTASK1071050 [TISC]Pleae clarify the reason why Processing Status of the latest source is \"Duplicate\", not change to \"Processed\"",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1089053",
      "parent_case": "CS8259804",
      "subject": "Access Denied in Microsoft SharePoint File Explorer Connector for Security Incident Response integration",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on fstechtest instance only The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? NO ------------------------------------ Assistance Requested: Assistance in investigating why the error is appearing when customer followed ServiceNow documentation itself Affected instance(s): fstechtest Affected version(s): Xanadu patch 7 Issue Definition: Customer wanted to integrate Sharepoint and MS Teams on Major Security Incident Management but we receive an \"access denied\" message on MSIM File repository configuration. Customer followed the steps described on the official MSIM Quick Start Guide and installing the provided \"MSIM FE SharePoint Update Set\". This is the predefined UpdateSet from KB1289784: https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1289784 Steps to Reproduce: 1. Hop to the instance 2. Go to Major Security Incident Management -> File Repository Configuration 3. Insert the informations described on the attached image (Site: sites/MSIM, DocLib: SIR) 4. Click Validate Investigation Summary: 1.) Reproduced the issue. 2.) Got below error log: https://fstechtest.service-now.com/nav_to.do?uri=syslog_app_scope.do?sys_id=b1e9818797d1ee10237a392de053afe9 <context_map>{\"_system_id\":\"app135016.ams101.service-now.com:fstechtest002\",\"_logged_in_user\":\"meghant.rai@snc\",\"_script_record\":\"2ba5e5dec7c32010603cb51927c2603d\",\"_scope\":\"sn_fe_sharepoint\",\"_txid\":\"91e901c397d1\",\"_session_id\":\"1A69810797D1EE10237A392DE053AF8D\",\"_page_name\":\"sn_fe_file_repo_drive.do\",\"_logger_name\":\"sn_fe_sharepoint.sys_script.2ba5e5dec7c32010603cb51927c2603d\",\"_user\":\"meghant.rai@snc\",\"_is_impersonating\":\"false\",\"_script_table\":\"sys_script\"}</context_map> Checked on Splunk: Query: sourcetype=appnode_localhost_log index=appnode_log_ams_sub instance=fstechtest txid=91e901c397d1 Date: 8th May Got below error 2025-05-08 06:13:08 (169) Default-thread-10 1A69810797D1EE10237A392DE053AF8D txid=91e901c397d1 SS_2ba5e5dec7c32010603cb51927c2603d SEVERE *** ERROR *** sn_fe_sharepoint (): Access denied. 2025-05-08 06:13:08 (168) Default-thread-10 1A69810797D1EE10237A392DE053AF8D txid=91e901c397d1 SSI_545d3d67c7392010603cb51927c26035 Operation against file 'sn_fe_file_repo_drive' was aborted by Business Rule 'Validate and populate sharepoint props^c972bc7fc7c030102450ed6c95c260ed'. Business Rule Stack:Validate and populate sharepoint props Unable to find any relevant cases with respect to this error, kindly let me know why access is denied even for maint user.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1091006",
      "parent_case": "CS8061901",
      "subject": "When \"Start conference call\" from Major Security Incident in MSIM workspace, how to switch to a different zoom connection.",
      "description": "REQUEST: Customer has multiple zoom connection configured on the instance and would like ability to switch zoom connection INVESTIGATION SUMMARY: * Customer has multiple zoom connections on the instance (see screnshot --> multiple.zoom.connections.png) https://intuitstage.service-now.com/nav_to.do?uri=%2Fsys_alias_list.do%3Fsysparm_query%3DnameLIKEzoom%26sysparm_first_row%3D1%26sysparm_view%3D%26sysparm_choice_query_raw%3D%26sysparm_list_header_search%3Dtrue * When customer click on \"Start a Conference button\" from MSIM, it only shows the default and does not have ability to use the second connection. * Customer would like ability to pick the other connection. AFFECTED INSTANCES: intuitstage STEPS TO REPRODUCE: => Go to MSIM workspace => open a major incident https://intuitstage.service-now.com/now/msim/major-security-incident/1ec724e4871caa143d817556cebb3529 => Click on \"Start a conference button\" => Notice only main connection to zoom is available.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1090774",
      "parent_case": "CS8240589",
      "subject": "4320 daily error log on the sn_si_aw source",
      "description": "------------------------------------​ Please conduct testing on __FILL_IN_SUBPROD_NAME_HERE__ instance only.​ ISSUE ONLY IN PROD. The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? Yes ------------------------------------​ Assistance Requested: Need help to find the cause. Thank you for the assistance.​ Affected instance(s): mycampari PRODUCTION​ Affected version(s): Xanadu Patch 7​ Issue Definition: Everyday, system tracks 4320 error log with the source \"sn_si_aw\". All the errors are the same: Error while processing queued entries for risk score calculator.: ReferenceError: \"sn_escm_ws_cmn\" is not defined. Steps to Reproduce: 1-log into production environment 2-open the sys log 3- set the filter as message=Error while processing queued entries for risk score calculator.: ReferenceError: \"sn_escm_ws_cmn\" is not defined Investigation Summary: ​ Please refer the screenshots. Updating the solution: ——————————————————————————————————————————————————————————————————— The script include is NOT missing. The script include is just not available because, the \" Security Case Management common workspace components \" plugin is not installed. Thus, errors are encountered. https://mycampari.service-now.com/v_plugin_list.do?sysparm_query=nameSTARTSWITHSecurity%20Case%20Management%20common%20workspace%20components&sysparm_first_row=1&sysparm_view=&sysparm_choice_query_raw=&sysparm_list_header_search=true The script include is a part of the plugin ==> Security Case Management common workspace components. As the plugin is not installed the script include is also not available. SOLUTION: Try to install this plugin - \" Security Case Management common workspace components\" in any sub-production instance to see if the issue is resolved. If you are facing the same issue in subprod then, it is best to test and implement the solution in subprod first. PLEASE NOTE: Please do not install directly anything on PROD. VALIDATION: See if the errors are resolved. ——————————————————————————————————————————————————————————————————— —————————————— CUSTOMER REPLIED: —————————————— I checked on the client subscription . The client has purchased the \"Security Operations Standard - SIR\". In the subscription applications does not appear the \"Security Operations Common Framework Components\" application (see also the file attached). is this plugin included in the \"Security Operations Standard - SIR\" subscription? Furthermore, if it is not included, is it possible to find another way to avoid the error messages? Knowledge Articles Researched:​ https://store.servicenow.com/store/app/d159afae1be06a50a85b16db234bcb56 Customer Q: Why this error appears and communicate the resolution please? Please assist further to find out the cause and fix of this issue. Thank you so much for the help in advance!",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1090985",
      "parent_case": "CS8241871",
      "subject": "Case Assistance request - Continuation of CSTASK1004776 - Missing and or delayed tickets from SecOps integration",
      "description": "------------------------------------ Please conduct testing on ibmcasocprod instance only. The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes ------------------------------------ Assistance Requested: Missing and or delayed tickets from SecOps integration Affected instance(s): ibmcasocprod Affected version(s): Xanadu Patch 7 Issue Definition: The QRadar offense ingestion integration has been configured with an active MID server and profile, following standard practices. Despite the connection being established successfully, offenses are consistently missing or delayed in the SIR table. This issue results in missing or delayed offenses, preventing proper incident tracking and response. Efforts to troubleshoot the problem—including review of logs, verification of integration setup, and following available documentation—have so far been unable to identify the root cause. This problem has persisted over time, affecting the organization's ability to maintain proactive security incident management. Steps to Reproduce: See problem record PRB0040002 in the 'ibmcasocprod' instance on the list of delayed SIRs Investigation Summary: ➜ Background of how QRADAR data is retrieved by ServiceNow : The scheduled jobs below are designed to trigger API calls to QRadar in order to fetch data. The first call retrieves the profile, and based on this profile, the system checks for an existing QRadar profile in the instance and assesses the next polling time. Once the polling time is reached, data is pulled from QRadar. This data is initially inserted into the incident raw table, then moved to the import set table, and finally transformed into the target table, sn_si_incident, to create the incident record. ↳ https://ibmcasocprod.service-now.com/sys_trigger_list.do?sysparm_query=next_actionONToday%40javascript%3Ags.beginningOfToday()%40javascript%3Ags.endOfToday()%5EnameLIKEibm%20qradar&sysparm_view= • IBM QRadar Field Import Queue Cleanup • IBM QRadar Offense Fields Import • IBM QRadar Offense Fields Import Queue Process • IBM QRadar Process Polling Queue • IBM QRadar Process Profiles and Offense Updates - For analysis, i picked offense id : 22370 \"start_time\":{\"value\":\"2025-05-10 03:11:12 UTC\"},\" ---> 2025-05-09 23:11:12 EST.- SIR created 2025-05-10 01:25:12 EST, A delay of 2.5 hours was seen before task was created. - IBM QRadar Offense Import ↳ https://ibmcasocprod.service-now.com/now/nav/ui/classic/params/target/sn_sec_qradar_offense_import.do%3Fsys_id%3Dadf1f56333112210384693123d5c7b66%26sysparm_record_target%3Dsn_sec_qradar_offense_import%26sysparm_record_row%3D1%26sysparm_record_rows%3D1%26sysparm_record_list%3Doffense_idIN22370%255EORDERBYDESCsys_updated_on - IBM QRadar Offense to Task,\"first_persisted_time\":{\"value\":1746846887000},\" ↳ https://ibmcasocprod.service-now.com/now/nav/ui/classic/params/target/sn_sec_qradar_offense_to_task.do%3Fsys_id%3Dbef1fd6333112210384693123d5c7b50%26sysparm_record_target%3Dsn_sec_qradar_offense_to_task%26sysparm_record_row%3D1%26sysparm_record_rows%3D1%26sysparm_record_list%3Doffense_idIN22370%255EORDERBYDESCsys_created_on ➜ HTTP Outbound LOGS::: - First outbound HTTP API call seen 2025-05-10 01:03:38 then last HTTP API communication 2025-05-11 02:14:11.From the first outbound HTTP get message at 2025-05-10 01:03:38 SIR was created 2025-05-10 01:25:12 EST ↳ https://ibmcasocprod.service-now.com/now/nav/ui/classic/params/target/sys_outbound_http_log_list.do%3Fsysparm_first_row%3D1%26sysparm_query%3Dresponse_bodyLIKE22370%26sysparm_view%3D - Once the data is received, it is processed by the FLOW to create the SIR records. - 'Process Profiles from Scheduled Job and Queue Offenses': This FLOW is triggered by a scheduled job every minute to pull offenses per profile based on the polling interval. This pulls offenses and queues them to the polling table for further processing. ↳ Documentation reference # https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-sir/secops-integration-qradar-ibm/concept/ibm-qradar-flow-designer.html ➜ Delay in Job execution ::: Furthermore, looking at the job execution history of the above IBM QRADAR jobs, I can see the jobs were started with a delay, which is assumed to be due to the volume of data processed in the previous execution. Refer to the attachment and the URL below for details. ↳ https://ibmcasocprod.service-now.com/sys_scheduler_job_history_list.do?sysparm_query=time_range_endBETWEENjavascript%3Ags.dateGenerate('2025-04-30'%2C'07%3A00%3A00')%40javascript%3Ags.dateGenerate('2025-04-30'%2C'09%3A59%3A59')%5Ejob_classificationLIKEqradar&sysparm_view= ➜ Flow logs:: - Looking at the workflow I'm seeing Workflow \"Process Profiles from Scheduled Job and Queue Offenses\" with extreme runtime values. ↳ https://ibmcasocprod.service-now.com/now/nav/ui/classic/params/target/sys_flow_context_list.do%3Fsysparm_first_row%3D1%26sysparm_query%3Dsys_created_onBETWEENjavascript%253Ags.dateGenerate%2528%25272025-05-09%2527%252C%252723%253A00%253A00%2527%2529%2540javascript%253Ags.dateGenerate%2528%25272025-05-10%2527%252C%252702%253A00%253A00%2527%2529%255EnameLIKEProcess%2BProfiles%2Bfrom%2BScheduled%2BJob%2Band%2BQueue%2BOffenses%26sysparm_view%3D ➢ Also, with the latest version of the IDM Qradar app, which I see is installed in the customer instance, the 'start_time' offense field for ingestion is no longer used to fetch the data as it is not an accurate representation of offense-triggered time. To overcome this issue, we updated the query to include the 'first_persisted_time field' in the In Flow designer action \"Fetch Offenses for profile and Queue records in polling table\" which is used by the FLOW 'Process Profiles from Scheduled Job and Queue Offenses'. Docs referred: ↳ https://www.servicenow.com/docs/bundle/yokohama-security-management/page/product/secops-integration-sir/secops-integration-qradar-ibm/concept/ibm-qradar-trouble.html Next steps: ➢ The steps below have been followed, but did not help to resolve the issue, hence requesting further assistance on how to avoid delay in SIR via QRADR 1. Disabled duplicate profiles 2. Verified MID server issues not affecting SecOps integration 3. Increased polling interval 4. Increased overlapping time from 0 to 5 minutes to ensure offenses at polling cutoffs are re-queried. 5. Extended queue timeout from 150 to 300 seconds so offenses don't prematurely move into later cycles. 6. Expanded offense batch processing from 30 to 75 offenses per cycle to process incidents more efficiently. 7. Reduced property timeout value for AQL query which fetches recent flows/events for a particular offense from 360 to 270 seconds so there's no overlap.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1087844",
      "parent_case": "CS8225602",
      "subject": "MISP attributes are not getting added on the MISP event",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on philipstest instance only The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes/No ------------------------------------ Assistance Requested: When a SIR is associated with the MISP event, the attributes tab in the MISP event is not getting populated (Refer screenshot attached) Affected instance(s): philipstest Affected version(s): YP1 Steps to Reproduce: 1. Create A SIR, when in draft - sample record SIR0035734 2. Add an observable to any sample domain 3. When the status is moved to the identification state 4. After this wait for 2-3 mins there will be a MISP event created 5. Open the MISP event and the associated MISP event gets added but the corresponding event does not have attributes populated.(check screesnhot attached) Investigation Summary: **Sample SIR for investigation \"SIR0035734\". **Now, how will an SIR be associated with the \"sn_sec_misp_observable_enrichment_result\" or, in other words, how do we decide what misp results should be displayed in the SIR? That logic is present here : https://philipstest.service-now.com/sys_relationship.do?sys_id=e33fdb8b53232010e297ddeeff7b1205&sysparm_record_rows=1&sysparm_record_scope=67ef9d029e1320105da138e2d546f10b&sysparm_record_target=sys_relationship&sysparm_record_list=nameCONTAINSmisp%5EORDERBYname&sysparm_nostack=true&sysparm_record_row=1 **We can see that in the related list of SIR there is a tab \"MISP enrichment result\" that is getting populated as expected which refers to the same table as that of attributes **Now, if you look in the table \"sn_sec_misp_observable_enrichment_result,\" you can find the records related to observables in the SIR. The question is why they are not displayed in the SIR when the results are in the \"sn_sec_misp_observable_enrichment_result\" table. https://philipstest.service-now.com/sn_sec_misp_observable_enrichment_result_list.do?sysparm_nostack=true&sysparm_query=&sysparm_view=Security_Incident_Affected_Services **But when we open the MISP event record and check for attributes, the same does not get populated **Also cusotmer highlighted that the issue is observed only after upgrade.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1090592",
      "parent_case": "CS8266808",
      "subject": "Microsoft Sentinel Security Incident was not created in ServiceNow even though the condition matches and can see data in raw table",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on __FILL_IN_SUBPROD_NAME_HERE__ instance only OR This issue is only available in PROD: \"omv\" The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? No ------------------------------------ Assistance Requested: Microsoft Sentinel Security Incident was not created in ServiceNow even though the condition matches and can see data in raw table Affected instance(s): omv Affected version(s): Xanadu Patch 7 Issue Definition: Microsoft Sentinel Security Incident was not created in ServiceNow even though the condition matches and can see data in raw table Steps to Reproduce: 1) check below url which didn't create any SIR: https://omv.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_raw.do?sys_id=25de2d5b3b916a50e5c09eaf55e45a57 Investigation Summary: 1. No customization with sentinel script includes 2. No error in log table and don't see anything in splunk https://splunk.servicenow.net/en-GB/app/search/search?earliest=1746741600&latest=1746828000&q=search%20instance%3Domv%20%2225de2d5b3b916a50e5c09eaf55e45a57%22&display.prefs.events.offset=0&sid=1747054447.52780_2E64B6A5-3172-4185-9C7D-0DCE1FF179CF&display.page.search.mode=verbose&dispatch.sample_ratio=1 3. Profile looks fine: https://omv.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_profile.do?sys_id=60b11b0dc381de1487f63fbf0501313a 4. Data came in raw table: https://omv.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_raw.do?sys_id=25de2d5b3b916a50e5c09eaf55e45a57 5. Ignored rows in import set: https://omv.service-now.com/nav_to.do?uri=sys_import_set_run.do?sys_id=2e7efc53fb916e10c98af2c98eefdc05 6. Import set: https://omv.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_import.do?sys_id=ea7e7c53fb916e10c98af2c98eefdc37 7. sn_sec_sentinel_incident_to_task record for SIR: not found https://omv.service-now.com/sn_sec_sentinel_incident_to_task_list.do?sysparm_query=incident_idSTARTSWITH8ff423b7-bd4e-47c1-9524-edd652ac015f&sysparm_view= 8. Nothing in Application log table with Sentinel incident id: https://omv.service-now.com/syslog_app_scope_list.do?sysparm_query=sys_created_onON2025-05-09%40javascript%3Ags.dateGenerate('2025-05-09'%2C'start')%40javascript%3Ags.dateGenerate('2025-05-09'%2C'end')%5Esys_scope%3D2e79ad6cfe4220103a962200674b7b51%5EmessageLIKE36092%5EORmessageLIKE8ff423b7-bd4e-47c1-9524-edd652ac015f%5EORmessageLIKE9a724ede-822c-4901-b32c-6ba41abb8149&sysparm_view= Knowledge Articles Researched: https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/secops-integration-sir/secops-integration-ms-azure-sentinel/concept/microsoft-azure-sentinel-integration.html",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1088703",
      "parent_case": "CS7916307",
      "subject": "Some Users are able to view the SIR records but notall of its attachments even when they should be able to read them.",
      "description": "------------------------------------​ Please conduct testing on \"tdbfgdev2\" subprod instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No ------------------------------------​ Assistance Requested: ​ ​Why some users are able to view the SIR records but not its attachments even when they should be able to read them in prod instance. Continuation of CSTASK1044672 Affected instance(s): tdbfgdev2​ (subprod instance), tdbfg (prod running on XP7 is also impacted) Affected version(s): Washingtondc Patch 10, Hot Fix 2a ​ Issue Definition: Few Users who are part of group who should have access to view all attachments to SIR are unable to view them. This issue is affecting currently on their prod and also observed on subprod instance consistently. Steps to Reproduce: 1. User Logs in to instance using their SSO which is their normal way of logging in to this issue 2. Access ex. SIR0100915 : https://tdbfgdev2.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=567f6ba5eb302a10e585fe2fbad0cd3e%26sysparm_view=gsi 3. Observe # of attachments on it The issue is not observed in the similar way when you impersonate the user so our testing cannot be solely relied after impersonating the user. *You will not observe the attachment records. Even as Maint user, we will not be able to view all the attachment records. Impersonating user also does not work. Zoom recording for Evidence : Link: https://servicenow.zoom.us/rec/play/OQdUx6vW4SJx8vf7nchYYoAcByKcEAcXjiP2zkFIIwrGyZK7Lzm05PZAfBBan0_k3x2DTlAPM8aLWS1y.Lo_DIvCU6uDCl5Jv Investigation Summary: ​ - Issue currently is reproducible on prod 'tdbfg' and 'tdbfgdev2' subprod instance where few users are unable to view all associated attachments to SIR record. Issue is not reproduced on 'tdbfgdev3' subprod which was recently cloned from prod. - We perform testing today on Non-working subprod instance: tdbfgdev2 (Washingtondc Patch 10, Hot Fix 2a) - Non-working user: 'Siran Mazloumian' UID: 'TAA4415@D2-TDBFG.COM' Group : 'GSIIM REPORTING TEAM - Canada' https://tdbfgdev2.service-now.com/sys_user_group.do?sys_id=0aeb28b81b83789418c875d6cc4bcbe2 you will only find 1 attachment out of 6 when logged in as this user - Working user: 'Jenny Hu' UID: 'HUTING7@D2-TDBFG.COM' - Example, SIR0100915 : https://tdbfgdev2.service-now.com/nav_to.do?uri=sn_si_incident.do?sys_id=567f6ba5eb302a10e585fe2fbad0cd3e%26sysparm_view=gsi It contains 6 attachments - This is the attachment table but as Maint we only see 1 attachment here. I have confirmed as working user there are 6 attachments, please find zoom recording for proof : https://tdbfgdev2.service-now.com/sys_attachment_list.do?sysparm_query=table_sys_id%3D567f6ba5eb302a10e585fe2fbad0cd3e&sysparm_view= - ACLs reviewed: https://tdbfgdev2.service-now.com/sys_security_acl_list.do?sysparm_query=nameSTARTSWITHsn_si_incident%5Eoperation.nameSTARTSWITHread%5Eactive%3Dtrue&sysparm_view= - Customized one on [sn_si_incident] : https://tdbfgdev2.service-now.com/nav_to.do?uri=sys_security_acl.do?sys_id=9ea7853c1b8bb89418c875d6cc4bcb93 tried reverting to OOB, same issue - Tried created new ACL read on [sys_attachment] but same issue after clearing cache. Have reverted back our changes to original now. - Tried adding affected user to \"FCIM - GSI Read All\" group which has more admin access, user was unable to read the attachments fine. Tried clearing both browser side cache, instance cache, tried changing browsers but same issue. - Tried adding affected user to same group as working user, Groups : GSI - IRC Shift Lead - Canada, GSI - MANAGERS - Canada, GSI - IRC Specialist - Canada then user did had access. We checked the Roles on these groups but user should have access to attachments even when they are not a part of these groups that have higher access roles as per customer - Impersonating users may not be reliable testing in this case. ​ - Node Logs for the transactions when issue was reproduced: https://splunk.servicenow.net/en-US/app/search/search?earliest=1746687600&latest=1746774000&q=search%20instance%20%3D%20tdbfgdev2%20%20%7C%20search%20%2271aa9a0feb1d%22%20%7C%20sort%20_time&sid=1746741770.326_96D7F2E5-86B6-4045-8120-80020393DFA3&display.page.search.mode=verbose&dispatch.sample_ratio=1 https://splunk.servicenow.net/en-US/app/search/search?earliest=1746601200&latest=1746774000&q=search%20instance%20%3D%20tdbfgdev2%20%20%7C%20search%20%2231aa56cbeb1d%22%20%7C%20sort%20_time&sid=1746741791.329_96D7F2E5-86B6-4045-8120-80020393DFA3&display.page.search.mode=verbose&dispatch.sample_ratio=1 - Lastly, ACL results for user 'Siran Mazloumian' on this ex. SIR0100915 : https://tdbfgdev2.service-now.com/now/access-analyzer/results/19848f83eb556610116bf8b5cad0cdde Similarly for attachment table: https://tdbfgdev2.service-now.com/now/access-analyzer/results/0e350fc3eb556610116bf8b5cad0cdcc It passes Read acls",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1089929",
      "parent_case": "CS8233444",
      "subject": "Dev Assistance Request: Duplicate stage \"Resource Development\" appearing in MITRE Att&ck Heat Map",
      "description": "------------------------------------​ Please conduct testing on xanadusecops instance only.​ The customer has NOT authorized access/changes to other instance(s.)​ SNC Access Control? No​ ------------------------------------​ Assistance Requested: See the screenshot attached. I tried reproducing the behaviour in my OOB instance but could not. We have tried multiple instances and this is the only instance where issue is happening. Affected instance(s): xanadusecops​ Affected version(s): Xanadu​ P7 Steps to Reproduce: 1. Navigate to Threat Intelligence > Heatmap and Navigator. 2. Select Enterprise Att&ck in Heat Map canvas. 3. Observe duplicate stage \"Resource Development\" appearing in MITRE Att&ck Heat Map Investigation Summary: ​ Posted on dev channel https://teams.microsoft.com/l/message/19:dxg_nLZcz45megxv6a4wO1WyXZgt9V0VmU5U0C0Ao6g1@thread.tacv2/1745840765484?tenantId=8bcff170-9979-491e-8683-d8ced0850bad&groupId=9ea2a45b-7706-4f7e-8abc-8ec05ba4144d&parentMessageId=1745840765484&teamName=sir_swat-ServiceNow&channelName=General&createdTime=1745840765484 Please assist",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1089951",
      "parent_case": "CS8242640",
      "subject": "SWARM Assistance required: sn_sec_splunkes: \"||\" (\"or\") conditions specified in \"aggregation_conditions\" field only partially work",
      "description": "------------------------------------ SNC Access Control? No ------------------------------------ Assistance Requested: sn_sec_splunkes: \"||\" (\"or\") conditions specified in \"aggregation_conditions\" field only partially work Affected instance(s): anztech anzinnovationsp Affected version(s): Yokohama P1 Issue Definition: The customer believes that there is a problem in sn_sec_splunkes 12.1.5 (anzinnovationsp) and 12.1.1 (anztech - production). For example, if they specify aggregation to be \"affected_user||cmdb_ci||correlation_id\" and submit 3 notables with valid/identical affected_user values, they get 1 ticket and 2 aggregations. Example: https://anzinnovationsp.service-now.com/nav_to.do?uri=sn_sec_splunkes_event_to_task.do?sys_id=6149cf2cc3dde21ca1f91823e4013152 . This ticket has 2 aggregations (see work notes or sn_sec_splunkes_event_to_task). The ticket was created using this event profile: https://anzinnovationsp.service-now.com/now/nav/ui/classic/params/target/sn_sec_splunkes_event_profile.do%3Fsys_id%3D8712326483116e1092aec920ceaad36d ++++This is the desired behaviour+++++++ If they change the order of the aggregations to be \"correlation_id||affected_user||cmdb_ci\" (or basically any other combo, where the 1st is not affected_user), the notables no longer aggregate & I get a separate ticket for each. The problem is not only limited to affected/specific user. ++++Below is the issue++++++++++ This is the event profile with the un-aggregated ticket creations: https://anzinnovationsp.service-now.com/now/nav/ui/classic/params/target/sn_sec_splunkes_event_profile.do%3Fsys_id%3D495b12e03399ea10ebb2e9223d5c7b06 . It is a copy of the other, with the fields re-ordered. and these are the 3 tickets created: https://anzinnovationsp.service-now.com/now/nav/ui/classic/params/target/sn_si_incident.do%3Fsys_id%3D21445ba0c3d1261ca1f91823e40131ed https://anzinnovationsp.service-now.com/now/nav/ui/classic/params/target/sn_si_incident.do%3Fsys_id%3D41441ba0c3d1261ca1f91823e40131d2 https://anzinnovationsp.service-now.com/now/nav/ui/classic/params/target/sn_si_incident.do%3Fsys_id%3D1c4497a0c3d1261ca1f91823e401319d You can see that affected_user is indeed resolved and the same for each (Jay Fry) For all of these examples, affected_user match and the other 2 not match (blank fields provided). Any non-match to the left side of the \"||\" breaks the \"Or\" condition. So it appears that \"or\" condition doesn't work unless it's the 1st match. Investigation Summary: 1. Related cases, but not similar https://support.servicenow.com/sn_customerservice_case_list.do?sysparm_query=short_descriptionLIKEaggregation%5Eshort_descriptionLIKEsplunk&sysparm_view=case 2. no result found for \"aggregation_conditions\" in background script when tried to verify if that is OOB logic *** Could you please kindly assist as I have never come across with this product and seems an uncommon secops issue. Thank you. Best regards, Dan Jeon",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1089949",
      "parent_case": "CS8061901",
      "subject": "Swarm: Troubleshooting Assistance - When \"Start conference call\" from Major Security Incident in MSIM workspace, how to switch to a different zoom connection.",
      "description": "REQUEST: Customer has multiple zoom connection configured on the instance and would like ability to switch zoom connection INVESTIGATION SUMMARY: * Customer has multiple zoom connections on the instance (see screnshot --> multiple.zoom.connections.png) https://intuitstage.service-now.com/nav_to.do?uri=%2Fsys_alias_list.do%3Fsysparm_query%3DnameLIKEzoom%26sysparm_first_row%3D1%26sysparm_view%3D%26sysparm_choice_query_raw%3D%26sysparm_list_header_search%3Dtrue * When customer click on \"Start a Conference button\" from MSIM, it only shows the default and does not have ability to use the second connection. * Customer would like ability to pick the other connection. AFFECTED INSTANCES: intuitstage STEPS TO REPRODUCE: => Go to MSIM workspace => open a major incident https://intuitstage.service-now.com/now/msim/major-security-incident/1ec724e4871caa143d817556cebb3529 => Click on \"Start a conference button\" => Notice only main connection to zoom is available.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1089916",
      "parent_case": "CS8264058",
      "subject": "Security Incident Task details may be visible within Safari's Developer Tools (Network tab - graphql section) on Mac OS.",
      "description": "********CASE TASK SUMMARY******** ------------------------------------ Please conduct testing on these instances only. - saptesttemp1 The customer has authorised access/changes to other instance(s.) - NO SNC Access Control? No ------------------------------------ Assistance Requested: The customer has reported that SIT details may be visible within Safari's Developer Tools (Network tab - graphql section) on Mac OS. This issue could pose a potential security risk, as the SIT details should not be visible to users without appropriate permissions. The issue appears to be isolated to specific users using Safari. The customer is concerned about a potential data breach since a user has reportedly seen data they were not authorised to access. Note: ***The customer instance has restrictions on impersonating.*** ***Those restrictions seem not to be applied in the temp instance copies.*** ------------------------------------ Affected instance(s): sap (production), saptesttemp1 ------------------------------------ Affected version(s): Xanadu Patch 8 ------------------------------------ ----------------------------------------------- Issue Definition: ----------------------------------------------- The customer has reported that SIT details may be visible within Safari's Developer Tools (Network tab - graphql section) on Mac OS. This issue could pose a potential security risk, as the SIT details should not be visible to users without appropriate permissions. The issue appears to be isolated to specific users using Safari. The customer is concerned about a potential data breach since a user has reportedly seen data they were not authorised to access. Note: ***The customer instance has restrictions on impersonating.*** ***Those restrictions seem not to be applied in the temp instance copies.*** ----------------------------------------------- Steps to Reproduce: ----------------------------------------------- *See \"SIR0071356.mp4\" attached to case User to Impersontae on TEMP instance : User ID : Yavor Mladenov (I328381) user can't read details in browser interface but in development tools you will see SIT data in the payload (Please see screen recording from customer) 1. Enable the Develop Menu: Open Safari on your Mac. Go to Safari > Settings (or Preferences). Click on the \"Advanced\" tab. Check the box next to \"Show Develop menu in menu bar\". 2. Access the Developer Tools: Once the \"Develop\" menu is visible in the Safari menu bar, you can access it. Within the \"Develop\" menu, you'll find options like: Show Javascript Console: Opens the console for debugging JavaScript code.You can also use the shortcut Option+⌘+C Show Web Inspector: Opens the Web Inspector for inspecting HTML, CSS, and JavaScript of a web page. You can also access it via the shortcut Option+⌘+I Other tools: The Develop menu also provides access to other web development tools like Debug toolbar for iOS and WebDriver Inspect Element: Right-click on any element on a webpage and select \"Inspect Element\" to access the Web Inspector ----------------------------------------------- Investigation Summary: ----------------------------------------------- >> Tried checking sub-prod because even though we can't make changes (per special handling) technically it does state we can impersonate in non-prod withour upfront approval, but no sn_si_incident records sapsandbox2 >> Archana stated that issue only occurs on Safari and Accenture Team (which she is a part of) is looking to get permission to acquire Safari as per their policy they can only use chrome or firefox but are unable to reproduce issue in these browsers >> Checking user \"Yavor Mladenov (I328381)\" doesn't have any sn_si roles specified in doc so ideally they should not be able to view sn_task from inspect tools. https://www.servicenow.com/docs/bundle/xanadu-security-management/page/product/security-incident-response/reference/installed-with-sir.html >> But during my testing (while in READ ONLY) as MAINT - in Chrome, I was able to see 'graphql' and payload as well. ------------ -- Attaching a screenshot of testing on Chrome to avoid alarming the customer and furthering frustration with this sensitive issue, but from my testing, we as maintenance can see this Graphql. -- Even though customer said they cannot reproduce, Support once cloning has completed should also make sure that this is not reproducible on chrome. If this is an issue we can reproduce on multiple browsers, this would be even more severe,. -- I was not able to test as the affected user on Chrome due to special handling regarding impersonation on prod. If this happens on chrome for only maint, that is fine because we have sufficient access. ------------ >> PROD impersonation sys_property \"glide.ui.impersonate_button.enable\": false so it will also be false on test temp.",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1088634",
      "parent_case": "",
      "subject": "Rule Mode field is not available in filtering options on DLP IR incident profile (sn_msft_dlp_incident_profile)",
      "description": "Rule Mode field is not available in filtering options on DLP IR incident profile (sn_msft_dlp_incident_profile) This issue is seen in latest OOB patches also Steps To Reproduce: 1) Hop to the instance empswethaxp6 2) Install DLP Incident Response integration with Microsoft 3) Open sn_msft_dlp_incident_profile record 4) Navigate to Filtering 5) Add filter and check if Rule Mode option is available to select. Investigation: --> The issue is observed in OOB instances --> When checked XML of sn_dlir_incident record, value of rule_mode is 'Enabled' Attached screenshots for reference. Can you please confirm if this is expected behavior and the reason for Rule mode not being available in filtering options?",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1084575",
      "parent_case": "CS8212929",
      "subject": "The system creates empty Splunk ES Event-to-Task records.",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ his issue is only available in PROD: shellacc2 The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes/No No ------------------------------------ Assistance Requested: Empty Splunk ES Event to Task records Affected instance(s):shellacc2 Affected version(s):Yokohama P1 Issue Definition:Empty Splunk ES Event to Task records Steps to Reproduce: NA Investigation Summary: -->Had zoom session with the customer and There are a few records being created each day with empty fields in the table sn_sec_splunkes_event_to_task. -->The \"notable_id\" field is also empty, and customer's concern is to understand why these records contain no data and if there is no data why the records are inserted. -->Splunk ES event to Task: https://shellacc2.service-now.com/sn_sec_splunkes_event_to_task_list.do?sysparm_query=sys_created_by%3Dsystem%5Enotable_event_id%3DNULL%5Esys_created_onONToday%40javascript%3Ags.beginningOfToday()%40javascript%3Ags.endOfToday()&sysparm_view= -->URL:https://shellacc2.service-now.com/sn_sec_splunkes_event_to_task_list.do?sysparm_query=sys_created_by%3Dsystem%5Enotable_event_id%3DNULL%5Esys_created_onONToday%40javascript%3Ags.beginningOfToday()%40javascript%3Ags.endOfToday()&sysparm_view= -->We have observed that these records are being created by the system. -->Record created on 1st may: https://shellacc2.service-now.com/nav_to.do?uri=sn_sec_splunkes_event_to_task.do?sys_id=3c718bfc8719e250576c0e99cebb3569 -->Transaction logs: 025-05-01 15:06:14 (397) worker.7 worker.7 txid=66c0477c8719 LocalhostTransactionLogger *** Start Background transaction - system, type: other, user: system 2025-05-01 15:06:14 (400) worker.7 worker.7 txid=66c0477c8719 JobExecutor Starting: Splunk ES Process events to SIR.072dd00a87bd5e10576c0e99cebb3526, Trigger Type: Repeat, Priority: 100, Upgrade Safe: true, Repeat: 30 SecondsName: Splunk ES Process events to SIR 2025-05-01 15:06:16 (519) worker.7 worker.7 txid=66c0477c8719 SSI_3067db120fa23300012db8a276767e90 context=Transformer, fThrottlerSources=[ReadReplicaThrottlerSource(enabled=true, thresholdSecs=150, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null), StandbyThrottlerSource(enabled=false, thresholdSecs=1200, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null)] 2025-05-01 15:06:16 (521) worker.7 worker.7 txid=66c0477c8719 SSI_3067db120fa23300012db8a276767e90 Using import set: ISET4481494, table sn_sec_splunkes_event_import 2025-05-01 15:06:16 (582) worker.7 worker.7 txid=66c0477c8719 SSI_3067db120fa23300012db8a276767e90 total: 1, inserts 0, updates 0, processed 0, ignored 1, skipped 0, errors 0 2025-05-01 15:06:16 (589) worker.7 worker.7 txid=66c0477c8719 SSI_3067db120fa23300012db8a276767e90 WARNING *** WARNING *** Evaluator: com.glide.script.RhinoEcmaError: Cannot read property \"task\" from null 2025-05-01 15:06:16 (660) worker.7 worker.7 txid=66c0477c8719 SSI_3067db120fa23300012db8a276767e90 context=Transformer, fThrottlerSources=[ReadReplicaThrottlerSource(enabled=true, thresholdSecs=150, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null), StandbyThrottlerSource(enabled=false, thresholdSecs=1200, lag=null, factor=0.05, runTimeMillis=0, lastCheck=null, currentCheck=null)] -->Scheduled job \"Splunk ES Process events to SIR\" : https://shellacc2.service-now.com/nav_to.do?uri=sysauto_script.do?sys_id=620ab32dc7651110b782e36827c260e9 -->ISET \"ISET4481494\" : https://shellacc2.service-now.com/nav_to.do?uri=sys_import_set.do?sys_id=8b770df0c355e2d4cc29325a050131ec -->ISET has all rows 36594 rows ignored and processed by the job \"Splunk ES Process events to SIR\" -->Transform map:https://shellacc2.service-now.com/nav_to.do?uri=sys_transform_map.do?sys_id=68572b810f073300012db8a276767ec6 target table \"sn_sec_splunkes_event_to_task\" staging table \"sn_sec_splunkes_event_import\" -->Currently customer instance is in 12.1.5 version and the latest version available is 12.1.6 -->Transform script (on before): (function runTransformScript(source, map, log, target /*undefined onStart*/ ) { // Add your code here if(gs.nil(source.profile)) ignore = true; var coalesce = new SplunkESFieldMapCoalesce(); var ret = coalesce.transform(source, target, 1); if(gs.nil(ret)) ignore = true; })(source, map, log, target); -->Script incude \"SplunkESFieldMapCoalesce\" is invoked in the transform script. Need further inputs on why the empty records are created in \"sn_sec_splunkes_event_to_task\" table",
      "close_notes": ""
    },
    {
      "case_number": "CSTASK1087648",
      "parent_case": "CS8225946",
      "subject": "Swarm: Troubleshooting Assistance - Require a solution to have Azure Sentinel comment sync jobs execute concurrently",
      "description": "<<---CS - Integrations to Dev Task Template (Do Not Remove)-->> ------------------------------------ Please conduct testing on __FILL_IN_SUBPROD_NAME_HERE__ instance only OR This issue is only available in PROD: __FILL_IN_PROD_NAME_HERE__ The customer has NOT authorized access/changes to other instance(s.) SNC Access Control? Yes/No ------------------------------------ Assistance Requested: Need advice from dev regarding options for concurrent execution of the Azure Sentinel Comment Sync job. Affected instance(s): spirit Affected version(s): glide-xanadu-07-02-2024__patch7-02-27-2025 Issue Definition: Need advice from dev regarding options for concurrent execution of the Azure Sentinel Comment Sync job. Steps to Reproduce: Incident profiles: https://spirit.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_profile_list.do?sysparm_query=&sysparm_view= Scheduled job: https://spirit.service-now.com/nav_to.do?uri=sysauto_script.do?sys_id=2d100303b8d364105a43d10fad25cfb8 AzureSentinelScheduledJobExecution: https://spirit.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=79acc01353432010bb55ddeeff7b125d --- Look for invokeCommentSynchronization method. AzureSentinelCommentStatusSync: https://spirit.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=74840cf443813110dcd896ed3ab8f2fc --- Look for incidentCommentSync method. AzureSentinelProperties: https://spirit.service-now.com/nav_to.do?uri=sys_script_include.do?sys_id=b76e5bf1092660505a437508350874c3 --- Look for SOURCE_TO_TASK table property. Source table: https;//spirit.service-now.com/nav_to.do?uri=sn_sec_sentinel_incident_to_task_list.do Investigation Summary: Customer uses Azure Sentinel Incident Ingestion for Security Operations and is experiencing long-running executions of the Azure Sentinel Comment Sync job, taking in excess of six hours to complete. I have compared their production and non-production instances and the major difference lies in the fact that the production environment contains 13 incident profiles, meaning there are 13 different Azure Sentinel connections being made from the instance, and the scheduled job is running on only one node. The integration maps over records in the sn_sec_sentinel_incident_to_task table, which currently contains over 31k records, and performs a bidirectional sync with the Sentinel endpoint associated with the incident profile.",
      "close_notes": ""
    }
  ]
}